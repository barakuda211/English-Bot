<html><head><LINK href="main.css" rel="STYLESHEET">
<title>Alvas.Audio (for C# and VB.Net Developers) plays and records sound in PCM, Microsoft ADPCM, IMA ADPCM, CCITT A-Law, CCITT u-Law, GSM 6.10, MPEG Layer-3 (mp3), Dialogic VOX</title></head>
<body>
<div id=printbutton align=left>
Take the latest version at <a href=http://alvas.net/alvas.audio,tips.aspx>http://alvas.net/alvas.audio,tips.aspx</a> :: 
<input type="button"  onclick="javascript:document.getElementById('printbutton').style.display='none';window.print();" value="Print">
<hr/>
</div>
<table width="100%" height="100%" border="0" cellpadding="5"><tr><td><h1><a name="questions"> 
		Questions about Alvas.Audio <a href="http://alvas.net/Doc/alvas.audio,tips.pdf">[Download Alvas.Audio tips in PDF]</a></a></h1></td></tr><tr><td><a href="#tip1"><font color="navy"><strong>1. Is it possible to merge several audio (wave) files that I have on disk and produce a single audio wave file?</strong></font></a></td></tr><tr><td><a href="#tip2"><font color="navy"><strong>2. I want to read an existing wav file, change the format then write it back out.</strong></font></a></td></tr><tr><td><a href="#tip3"><font color="navy"><strong>3. If I buy Single License for Alvas.Audio, will there be no 'about window'  
deployed on the customers apllication whenever the application is started?</strong></font></a></td></tr><tr><td><a href="#tip4"><font color="navy"><strong>4. Does your .net component require any dependency files?</strong></font></a></td></tr><tr><td><a href="#tip5"><font color="navy"><strong>5. Is the runtime license free?</strong></font></a></td></tr><tr><td><a href="#tip6"><font color="navy"><strong>6. Do you provide some c# code with the classes?</strong></font></a></td></tr><tr><td><a href="#tip7"><font color="navy"><strong>7. I would like to know under what .Net language is the Audio application
written?</strong></font></a></td></tr><tr><td><a href="#tip8"><font color="navy"><strong>8. Can you please confirm that if I buy a single user license for Alvas Suite,
that it also includes Alvas.Audio?</strong></font></a></td></tr><tr><td><a href="#tip9"><font color="navy"><strong>9. Can we use Alvas.Audio for Pocket PC applications?</strong></font></a></td></tr><tr><td><a href="#tip10"><font color="navy"><strong>10. It appears to be necessary to select input and output devices. I would like to simply use the default devices that the user has selected on the control panel. Is this possible?</strong></font></a></td></tr><tr><td><a href="#tip11"><font color="navy"><strong>11. I need to be able to convert Dialogic files to MP3</strong></font></a></td></tr><tr><td><a href="#tip12"><font color="navy"><strong>12. Can you send me the complete list of all audio formats that can be converted
FROM and converted TO using Alvas.Audio?</strong></font></a></td></tr><tr><td><a href="#tip13"><font color="navy"><strong>13. I want to decode a GSM-stream, but after a quick glance in the example-code and at Alvas.Audio.chm I can't really see how to do that.</strong></font></a></td></tr><tr><td><a href="#tip14"><font color="navy"><strong>14. I'm using the Alvas.Audio.dll, and i'm trying to play 2 wav's at the same
time (I don't want the first one to stop when the second one begins). How can I make this happen?</strong></font></a></td></tr><tr><td><a href="#tip15"><font color="navy"><strong>15. Is this control suitable for use in MC++ Windows forms projects?</strong></font></a></td></tr><tr><td><a href="#tip16"><font color="navy"><strong>16. Would your audio compenent be suitable for Voip, would it decode and encode 
fast enough to keep latency at a minimum. Has it been used in this type of environment.</strong></font></a></td></tr><tr><td><a href="#tip17"><font color="navy"><strong>17. Can I use your audio toolkit to extract portions of a wav file to a new wav file?</strong></font></a></td></tr><tr><td><a href="#tip18"><font color="navy"><strong>18. Have you tested the audio on Vista?</strong></font></a></td></tr><tr><td><a href="#tip19"><font color="navy"><strong>19. Is it possible to insert new recordings into existing WAV files?</strong></font></a></td></tr><tr><td><a href="#tip20"><font color="navy"><strong>20. What does a single license entitle us to do, and how does it affect sales of 
software produced that include Alvas.Audio.</strong></font></a></td></tr><tr><td><a href="#tip21"><font color="navy"><strong>21. How do I stop (not pause) audio that's allready playing in command?</strong></font></a></td></tr><tr><td><a href="#tip22"><font color="navy"><strong>22. I would like to use your audio control for VoIP. Record to memory (Speex)
and send the data by UDP the receive from UDP and playback raw data.
Would your control be suitable for this purpose?</strong></font></a></td></tr><tr><td><a href="#tip23"><font color="navy"><strong>23. Using either the WaveReader or Player(Ex) classes,
is there anyway for me to tell how long (in seconds) a WAV file is?</strong></font></a></td></tr><tr><td><a href="#tip24"><font color="navy"><strong>24. I'm looking for a way via a web page to convert a saved Wav file to MP3.  Will your code allow me to do 
so?</strong></font></a></td></tr><tr><td><a href="#tip25"><font color="navy"><strong>25. I just need to get the duration in MS for a file.  This code will be on an 
ASP.NET website, so I want to instance your class, assign a file name (NOT 
PLAY THE FILE) and then just get the duration.
 
Is this possible with your Alvas.Audio classes - if so, which class does it?</strong></font></a></td></tr><tr><td><a href="#tip26"><font color="navy"><strong>26. I am developing an application in VB.net 2.0, and i am looking for a library 
to transform u-law audio files into mp3. Could I get some sample 
code to help me get this to work?</strong></font></a></td></tr><tr><td><a href="#tip27"><font color="navy"><strong>27. Is it possible to default to a particular format on any machine (e.g.  'MP3,
20kbps, 11,025Hz, mono') without  the user having to specify it?  I need to
default to a low quality mp3 format for speech recording and I don't want
the user to have to select anything. I want to make it as simple as possible
for them.  Is it reliable to just iterate through the FormatTags and select
the right one based on matching a string? Or will different client machines
have different values/indexes for these tags?</strong></font></a></td></tr><tr><td><a href="#tip28"><font color="navy"><strong>28. I need to be able to convert from ADPCM 6khz 4-bit mono, ADPCM 8khz 4-bit mono, PCM8 8khz 8-but uLaw mono formats and 
standard formats such as WAV.</strong></font></a></td></tr><tr><td><a href="#tip29"><font color="navy"><strong>29. Must I pay a license for every deploy on my customer or only one for developer?</strong></font></a></td></tr><tr><td><a href="#tip30"><font color="navy"><strong>30. Reading / Writing of our VOX Files is not possibile.</strong></font></a></td></tr><tr><td><a href="#tip31"><font color="navy"><strong>31. Can you convert WAV files to the headerless formats like Dialogic VOX and PCM 8khz?</strong></font></a></td></tr><tr><td><a href="#tip32"><font color="navy"><strong>32. It can play from an array of doubles?</strong></font></a></td></tr><tr><td><a href="#tip33"><font color="navy"><strong>33. I was evaluating your product to use in an application for Asterisk(VOIP) 
solution, but I found there is no output support for SLINEAR. Do you plan to 
support this format? This would be a great option since there is no Windows 
application to make the conversion for Asterisk.</strong></font></a></td></tr><tr><td><a href="#tip34"><font color="navy"><strong>34. How to convert a wave file into an raw alaw 8Khz mono file?</strong></font></a></td></tr><tr><td><a href="#tip35"><font color="navy"><strong>35. We need to be able to essentially convert a wav file while adjusting its speed by a factor.</strong></font></a></td></tr><tr><td><a href="#tip36"><font color="navy"><strong>36. Does the Alvas.Audio library work with Terminal Services?</strong></font></a></td></tr><tr><td><a href="#tip37"><font color="navy"><strong>37. How to send audio stream in the browser?</strong></font></a></td></tr><tr><td><a href="#tip38"><font color="navy"><strong>38. How to Play big audio files?</strong></font></a></td></tr><tr><td><a href="#tip39"><font color="navy"><strong>39. Simple RecorderEx example</strong></font></a></td></tr><tr><td><a href="#tip40"><font color="navy"><strong>40. Simple PlayerEx example</strong></font></a></td></tr><tr><td><a href="#tip41"><font color="navy"><strong>41. Can you tell me whether the player will support playing Dialogic .vox (adpcm) format?</strong></font></a></td></tr><tr><td><a href="#tip42"><font color="navy"><strong>42. I expected that the RecorderEx.Data event would be raised whenever a buffer (size determined by BufferSize) was filled, but it's only raised on the half-second. Is there any way to reduce this?</strong></font></a></td></tr><tr><td><a href="#tip43"><font color="navy"><strong>43. How do I Boost the volume of an existing WAVE file - How can I make it louder?</strong></font></a></td></tr><tr><td><a href="#tip44"><font color="navy"><strong>44. Do you have any examples or sample applications that record directly to mp3?</strong></font></a></td></tr><tr><td><a href="#tip45"><font color="navy"><strong>45. Can Alvas.NET perform mp3 playing in C# with selected sound card. I have multiple sound card on my PC.</strong></font></a></td></tr><tr><td><a href="#tip46"><font color="navy"><strong>46. I would like to know if it is possible to record both line-in and line-out from a soundcard 
(full duplex).</strong></font></a></td></tr><tr><td><a href="#tip47"><font color="navy"><strong>47. Does Alvas.Audio support 64bit operating systems?</strong></font></a></td></tr><tr><td><a href="#tip48"><font color="navy"><strong>48. How can I check frequency (sample rate) of MP3 file?
The only way I could find is to use FormatDetails struct and parse frequency out of it's FormatName property. However, I'm sure there are nicer way to achieve this :)</strong></font></a></td></tr><tr><td><a href="#tip49"><font color="navy"><strong>49. I am a newbie trying to recode MP3 file to a different bit rate/sample 
rate/mode. Like changing the Bit rate, Sample rate or changing from stereo 
to mono or their combination.
 
I would really appreciate any help, with code if possible.</strong></font></a></td></tr><tr><td><a href="#tip50"><font color="navy"><strong>50. Can you give an example to convert a mp3 file from 320kbps bit rate, stereo, 
44khz sample rate to 48kbps bit rate, mono, 22khz.</strong></font></a></td></tr><tr><td><a href="#tip51"><font color="navy"><strong>51. Our company needs audio control, which can record separately and 
independently right and left channel from stereo input. Has Alvas.Audio got 
such functionality?</strong></font></a></td></tr><tr><td><a href="#tip52"><font color="navy"><strong>52. How can I get higher quality when converting from .vox to .mp3.</strong></font></a></td></tr><tr><td><a href="#tip53"><font color="navy"><strong>53. Could you be more specific about adding the control to the toolbox.</strong></font></a></td></tr><tr><td><a href="#tip54"><font color="navy"><strong>54. After the file has been played I want to delete it, but I get an “access denied” error, because the file is in use. Is there a way to release the file from the DSReader (or PlayerEx) so that I can delete it?</strong></font></a></td></tr><tr><td><a href="#tip55"><font color="navy"><strong>55. I'm looking for .net a component like yours that can convert .wma to .mp3 - can it easily to that.</strong></font></a></td></tr><tr><td><a href="#tip56"><font color="navy"><strong>56. Does Alvas.Audio work with Windows 7 RTM?</strong></font></a></td></tr><tr><td><a href="#tip57"><font color="navy"><strong>57. Is it possible to increase/amplify the volume of mp3 file using Alvas.Audio library?</strong></font></a></td></tr><tr><td><a href="#tip58"><font color="navy"><strong>58. Is it possible to work directly on free licence file formats like Ogg Vorbis?</strong></font></a></td></tr><tr><td><a href="#tip59"><font color="navy"><strong>59. Can I convert an MP3 file to .VOX format?</strong></font></a></td></tr><tr><td><a href="#tip60"><font color="navy"><strong>60. I have a byte array of PCM audio.  I would like to convert that to a byte array of GSM audio (and back).  Would your Alvas.Audio library be able to do that?</strong></font></a></td></tr><tr><td><a href="#tip61"><font color="navy"><strong>61. Is there a way to use a specific codec? For example, say I install the lame.acm as part of my application installation. Then the user decides to installs other codecs for some reason. Can I specifically ensure that I use my specific codec?</strong></font></a></td></tr><tr><td><a href="#tip62"><font color="navy"><strong>62. We're having some troubles with big audio files when we attempt to convert them from mp3 to wav: System.OutOfMemoryException: Exception of type 'System.OutOfMemoryException' was thrown.</strong></font></a></td></tr><tr><td><a href="#tip63"><font color="navy"><strong>63. Can Alvas.Audio can detect silence detection?</strong></font></a></td></tr><tr><td><a href="#tip64"><font color="navy"><strong>64. I would like to be able to select the input device like Microphone or CD Audio when recording sound.</strong></font></a></td></tr><tr><td><a href="#tip65"><font color="navy"><strong>65. Does your audio control allow real time monitoring of the lenght of the
recording? Basically while its recording, can I see position with the scroll bar?</strong></font></a></td></tr><tr><td><a href="#tip66"><font color="navy"><strong>66. Can your audio library playback Shoutcast or Icecast radio streams? I also need to extract metadata from stream.</strong></font></a></td></tr><tr><td><a href="#tip67"><font color="navy"><strong>67. First, can you jump to a specific spot in a wav file and start recording from there?  
Meaning could I record for say five seconds, then replay the sound, 
then jump to the middle of the recording and start recording again from there?</strong></font></a></td></tr><tr><td><a href="#tip68"><font color="navy"><strong>68. I'm listening to an internet radio station over my speakers, and I'd like to record what I hear, and directly to an mp3 file. Can your alvas.audio contol record 'what you hear'? If so, how?</strong></font></a></td></tr><tr><td><a href="#tip69"><font color="navy"><strong>69. I try to convert a file on my web page but the process get stuck.
The web page seems like it tries to load something but won't go on. What can I do?</strong></font></a></td></tr><tr><td><a href="#tip70"><font color="navy"><strong>70. I'm trying to trial your software, building it into our web application 
but the trial version I have downloaded won't work in my web app as it keeps 
trying to pop up a 'nag screen' which causes the app to throw an error. Is 
there any way to turn this off?</strong></font></a></td></tr><tr><td><a href="#tip71"><font color="navy"><strong>71. We are evaluating your Alvas.Audio product for a .net server side mixer 
and aren't able to evaluate it completely since we keep getting this error:
 
'Showing a modal dialog box or form when the application is not running in 
UserInteractive mode is not a valid operation. Specify the 
ServiceNotification or DefaultDesktopOnly style to display a notification 
from a service application.'
 
The error seems to come from the Alvas.Audio.AboutBox.ShowNagScreen, which I 
would guess has to do that we are running a demo.
 
Is there any way of testing server side things without getting that error 
just to make sure that it works for our project?</strong></font></a></td></tr><tr><td><a href="#tip72"><font color="navy"><strong>72. When converting audio from Wav to Mp3 and NOT using the Wave2Mp3 function, 
do you always need to convert the wave data into PCM data before converting it to MP3? 
Is there a reason for doing that?</strong></font></a></td></tr><tr><td><a href="#tip73"><font color="navy"><strong>73. I have to connect to a SHOUTcast stream, take 5 seconds of the sound then detect if there is silence (no sound above -14db). Would you be so kind to provide us with some sample?</strong></font></a></td></tr><tr><td><a href="#tip74"><font color="navy"><strong>74. I have multiple audio tracks with nothing but music.
     I have multiple recorded voice tracks no longer than 2-3 seconds each.
     What I would like to do is 'overlay' a voice track onto an audio
track at a specified time and output the results to a single file.
     E.g. Audio track is 2 minutes long, and I would like to insert
the voice track at 23 seconds as well 1m 05 seconds and at 1m 40
seconds.
Can Alvas.Audio accomplish this sort of task for me??</strong></font></a></td></tr><tr><td><a href="#tip75"><font color="navy"><strong>75. Effectively, I have a block of memory which contains A-law data and I want to play the data using vb.net. 
Can you provide some sample code on how I can achieve this with PlayerEx?</strong></font></a></td></tr><tr><td><a href="#tip76"><font color="navy"><strong>76. Can I use Alvas.Audio to play(stream) MP3 from the buffer of byte array. 
Please explain it with sample code in c#.</strong></font></a></td></tr><tr><td><hr><h2>Answers</h2></td></tr><tr><td><a name="tip1"><h2>1. Is it possible to merge several audio (wave) files that I have on disk and produce a single audio wave file?</h2> 
<div style="font-family: Courier New; font-size: 10pt; color: black; background: white;"> 
Yes, of course. If You want to join 2 files their formats should be 
identical. For Example You can join "CCITT u-Law 8 bit mono" with "CCITT 
u-Law 8 bit mono". Thus if You have "CCITT u-Law 16 bit mono" You have to 
convert it to "CCITT u-Law 8 bit mono" (use AudioCompressionManager.Convert 
method).
Please see example below.
<div class=code> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">private</span> <span style="color: blue;">void</span> Join()</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">string</span> path = <span style="color: teal;">Application</span>.StartupPath;</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: teal;">WaveReader</span> wr1 = <span style="color: blue;">new</span> <span style="color: teal;">WaveReader</span>(<span style="color: teal;">File</span>.OpenRead(path + <span style="color: maroon;">@"\one.wav"</span>));</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: teal;">IntPtr</span> format = wr1.ReadFormat();</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">byte</span>[] data1 = wr1.ReadData();</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; wr1.Close();</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: teal;">WaveReader</span> wr2 = <span style="color: blue;">new</span> <span style="color: teal;">WaveReader</span>(<span style="color: teal;">File</span>.OpenRead(path + <span style="color: maroon;">@"\two.wav"</span>));</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">byte</span>[] data2 = wr2.ReadData();</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; wr2.Close();</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: teal;">WaveWriter</span> ww = <span style="color: blue;">new</span> <span style="color: teal;">WaveWriter</span>(<span style="color: teal;">File</span>.Create(path + <span style="color: maroon;">@"\join.wav"</span>), <span style="color: teal;">AudioCompressionManager</span>.FormatBytes(format));</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; ww.WriteData(data1);</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; ww.WriteData(data2);</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; ww.Close();</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }</p> 
</div> 
</div> 
</a><br><a href="#questions" class="standardsButton"><font color="#ffffff"> 
		Up
		</font></a></td></tr><tr><td><a name="tip2"><h2>2. I want to read an existing wav file, change the format then write it back out.</h2> 
<div style="font-family: Courier New; font-size: 10pt; color: black; background: white;"> 
<div class=code> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">private</span> <span style="color: blue;">void</span> Convert()</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: teal;">WaveReader</span> read = <span style="color: blue;">new</span> <span style="color: teal;">WaveReader</span>(<span style="color: teal;">File</span>.OpenRead(<span style="color: maroon;">@"g:\~data\123.wav"</span>));</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: teal;">IntPtr</span> oldFormat = read.ReadFormat();</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: teal;">WaveFormat</span> wf = <span style="color: teal;">AudioCompressionManager</span>.GetWaveFormat(oldFormat);</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">byte</span>[] oldData = read.ReadData();</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: teal;">FormatDetails</span>[] fdArr = <span style="color: teal;">AudioCompressionManager</span>.GetFormatList(wf);</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: teal;">IntPtr</span> newFormat = fdArr[fdArr.Length - 1].FormatHandle;</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">byte</span>[] data = <span style="color: teal;">AudioCompressionManager</span>.Convert(oldFormat, newFormat, oldData, <span style="color: blue;">true</span>);</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: teal;">WaveWriter</span> write = <span style="color: blue;">new</span> <span style="color: teal;">WaveWriter</span>(<span style="color: teal;">File</span>.OpenWrite(<span style="color: maroon;">@"g:\~data\123_new.wav"</span>),</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: teal;">AudioCompressionManager</span>.FormatBytes(newFormat));</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; write.WriteData(data);</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; write.Close();</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; read.Close();</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }</p> 
</div> 
</div> 
</a><br><a href="#questions" class="standardsButton"><font color="#ffffff"> 
		Up
		</font></a></td></tr><tr><td><a name="tip3"><h2>3. If I buy Single License for Alvas.Audio, will there be no 'about window'  
deployed on the customers apllication whenever the application is started?</h2> 
<div style="font-family: Courier New; font-size: 10pt; color: black; background: white;"> 
Yes, of course. The 'about window' doesn't appear when You buy the product.
</div> 
</a><br><a href="#questions" class="standardsButton"><font color="#ffffff"> 
		Up
		</font></a></td></tr><tr><td><a name="tip4"><h2>4. Does your .net component require any dependency files?</h2> 
<div style="font-family: Courier New; font-size: 10pt; color: black; background: white;"> 
No, our components don't require any dependency file.
</div> 
</a><br><a href="#questions" class="standardsButton"><font color="#ffffff"> 
		Up
		</font></a></td></tr><tr><td><a name="tip5"><h2>5. Is the runtime license free?</h2> 
<div style="font-family: Courier New; font-size: 10pt; color: black; background: white;"> 
Yes, the runtime license is free.
</div> 
</a><br><a href="#questions" class="standardsButton"><font color="#ffffff"> 
		Up
		</font></a></td></tr><tr><td><a name="tip6"><h2>6. Do you provide some c# code with the classes?</h2> 
<div style="font-family: Courier New; font-size: 10pt; color: black; background: white;"> 
Yes, the source code is available in Team edition of the product.
</div> 
</a><br><a href="#questions" class="standardsButton"><font color="#ffffff"> 
		Up
		</font></a></td></tr><tr><td><a name="tip7"><h2>7. I would like to know under what .Net language is the Audio application
written?</h2> 
<div style="font-family: Courier New; font-size: 10pt; color: black; background: white;"> 
Controls are 100% native CLR compliant written in C# and can be used in C#, VB.Net and other .Net languages.
</div> 
</a><br><a href="#questions" class="standardsButton"><font color="#ffffff"> 
		Up
		</font></a></td></tr><tr><td><a name="tip8"><h2>8. Can you please confirm that if I buy a single user license for Alvas Suite,
that it also includes Alvas.Audio?</h2> 
<div style="font-family: Courier New; font-size: 10pt; color: black; background: white;"> 
Yes, of course. If You buy Alvas Suite it will include Alvas.Audio.
</div> 
</a><br><a href="#questions" class="standardsButton"><font color="#ffffff"> 
		Up
		</font></a></td></tr><tr><td><a name="tip9"><h2>9. Can we use Alvas.Audio for Pocket PC applications?</h2> 
<div style="font-family: Courier New; font-size: 10pt; color: black; background: white;"> 
No, Alvas.Audio can't be used for Pocket PC applications.
</div> 
</a><br><a href="#questions" class="standardsButton"><font color="#ffffff"> 
		Up
		</font></a></td></tr><tr><td><a name="tip10"><h2>10. It appears to be necessary to select input and output devices. I would like to simply use the default devices that the user has selected on the control panel. Is this possible?</h2> 
<div style="font-family: Courier New; font-size: 10pt; color: black; background: white;"> 
Yes, it is possible. You need to assign -1 to RecorderID.
Example,
 
recEx.RecorderID = -1;
</div> 
</a><br><a href="#questions" class="standardsButton"><font color="#ffffff"> 
		Up
		</font></a></td></tr><tr><td><a name="tip11"><h2>11. I need to be able to convert Dialogic files to MP3</h2> 
<div style="font-family: Courier New; font-size: 10pt; color: black; background: white;"> 
<div class=code> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp;&nbsp;            <span style="color: blue;">string</span> voxFile = <span style="color: maroon;">@"C:\AlvasAudio\8000.vox"</span>;</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp;&nbsp;            <span style="color: blue;">string</span> mp3File = <span style="color: maroon;">@"C:\AlvasAudio\8000.mp3"</span>;</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp;&nbsp;            Vox2Mp3(voxFile, 1, 16, 8000, mp3File);</p> 
 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp;&nbsp;        <span style="color: green;">//-------</span></p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp;&nbsp;        <span style="color: blue;">private</span> <span style="color: blue;">static</span> <span style="color: blue;">void</span> Vox2Mp3(<span style="color: blue;">string</span> voxFile, <span style="color: blue;">short</span> channels, <span style="color: blue;">short</span> bitsPerSample, <span style="color: blue;">int</span> samplesPerSec, <span style="color: blue;">string</span> mp3File)</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;            <span style="color: teal;">BinaryReader</span> br = <span style="color: blue;">new</span> <span style="color: teal;">BinaryReader</span>(<span style="color: teal;">File</span>.OpenRead(voxFile));</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;            <span style="color: teal;">MemoryStream</span> pcmStream = <span style="color: blue;">new</span> <span style="color: teal;">MemoryStream</span>();</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;            <span style="color: teal;">IntPtr</span> pcmFormat = <span style="color: teal;">AudioCompressionManager</span>.GetPcmFormat(channels, bitsPerSample, samplesPerSec);</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;            <span style="color: teal;">WaveWriter</span> ww = <span style="color: blue;">new</span> WaveWriter(pcmStream, <span style="color: teal;">AudioCompressionManager</span>.FormatBytes(pcmFormat));</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;            <span style="color: teal;">Vox</span>.Vox2Wav(br, ww);</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;            br.Close();</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;            <span style="color: teal;">IntPtr</span> mp3Format = <span style="color: teal;">AudioCompressionManager</span>.GetCompatibleFormat(pcmFormat, <span style="color: teal;">AudioCompressionManager</span>.MpegLayer3FormatTag);</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;            <span style="color: teal;">WaveReader</span> wr = <span style="color: blue;">new</span> <span style="color: teal;">WaveReader</span>(pcmStream);</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;            <span style="color: blue;">byte</span>[] pcmData = wr.ReadData();</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;            wr.Close();</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;            <span style="color: blue;">byte</span>[] data = <span style="color: teal;">AudioCompressionManager</span>.Convert(pcmFormat, mp3Format, pcmData, <span style="color: blue;">false</span>);</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;            <span style="color: teal;">BinaryWriter</span> bw = <span style="color: blue;">new</span> <span style="color: teal;">BinaryWriter</span>(<span style="color: teal;">File</span>.Create(mp3File));</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;            bw.Write(data, 0, data.Length);</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;            ww.Close();</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;            bw.Close();</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }</p> 
</div> 
</div> 
</a><br><a href="#questions" class="standardsButton"><font color="#ffffff"> 
		Up
		</font></a></td></tr><tr><td><a name="tip12"><h2>12. Can you send me the complete list of all audio formats that can be converted
FROM and converted TO using Alvas.Audio?</h2> 
<div style="font-family: Courier New; font-size: 10pt; color: black; background: white;"> 
Alvas.Audio uses Windows Audio Compression Manager to convert audio data. You
can install additional ACM-drivers. For example, "Ogg Vorbis for MSACM"
<a target=_blank href=http://www.free-codecs.com/Ogg_Vorbis_CODEC_for_MSACM_download.htm>http://www.free-codecs.com/Ogg_Vorbis_CODEC_for_MSACM_download.htm</a> 
</div> 
</a><br><a href="#questions" class="standardsButton"><font color="#ffffff"> 
		Up
		</font></a></td></tr><tr><td><a name="tip13"><h2>13. I want to decode a GSM-stream, but after a quick glance in the example-code and at Alvas.Audio.chm I can't really see how to do that.</h2> 
<div style="font-family: Courier New; font-size: 10pt; color: black; background: white;"> 
To encode a GSM-stream You need to run AudioExCS.exe demo and select "audio format tag" GSM 6.10.
To decode a GSM-stream You need to use the Conversion tab and select the file with GSM data...
</div> 
</a><br><a href="#questions" class="standardsButton"><font color="#ffffff"> 
		Up
		</font></a></td></tr><tr><td><a name="tip14"><h2>14. I'm using the Alvas.Audio.dll, and i'm trying to play 2 wav's at the same
time (I don't want the first one to stop when the second one begins). How can I make this happen?</h2> 
<div style="font-family: Courier New; font-size: 10pt; color: black; background: white;"> 
Instead of PlayerEx.AddData use PlayerEx.AddMixData.
</div> 
</a><br><a href="#questions" class="standardsButton"><font color="#ffffff"> 
		Up
		</font></a></td></tr><tr><td><a name="tip15"><h2>15. Is this control suitable for use in MC++ Windows forms projects?</h2> 
<div style="font-family: Courier New; font-size: 10pt; color: black; background: white;"> 
Yes, Alvas.Audio is suitable for use in MC++ (with managed extension) .Net Windows forms projects. 
Requirements: .Net Framework v1.1 or later (also .NET v3.5) 
</div> 
</a><br><a href="#questions" class="standardsButton"><font color="#ffffff"> 
		Up
		</font></a></td></tr><tr><td><a name="tip16"><h2>16. Would your audio compenent be suitable for Voip, would it decode and encode 
fast enough to keep latency at a minimum. Has it been used in this type of environment.</h2> 
<div style="font-family: Courier New; font-size: 10pt; color: black; background: white;"> 
Yes, of course.
</div> 
</a><br><a href="#questions" class="standardsButton"><font color="#ffffff"> 
		Up
		</font></a></td></tr><tr><td><a name="tip17"><h2>17. Can I use your audio toolkit to extract portions of a wav file to a new wav file?</h2> 
<div style="font-family: Courier New; font-size: 10pt; color: black; background: white;"> 
wr.ReadData(2, 1);
</div> 
</a><br><a href="#questions" class="standardsButton"><font color="#ffffff"> 
		Up
		</font></a></td></tr><tr><td><a name="tip18"><h2>18. Have you tested the audio on Vista?</h2> 
<div style="font-family: Courier New; font-size: 10pt; color: black; background: white;"> 
Yes, of course.
</div> 
</a><br><a href="#questions" class="standardsButton"><font color="#ffffff"> 
		Up
		</font></a></td></tr><tr><td><a name="tip19"><h2>19. Is it possible to insert new recordings into existing WAV files?</h2> 
<div style="font-family: Courier New; font-size: 10pt; color: black; background: white;"> 
Yes, you can insert audio data into existing WAV file.
</div> 
</a><br><a href="#questions" class="standardsButton"><font color="#ffffff"> 
		Up
		</font></a></td></tr><tr><td><a name="tip20"><h2>20. What does a single license entitle us to do, and how does it affect sales of 
software produced that include Alvas.Audio.</h2> 
<div style="font-family: Courier New; font-size: 10pt; color: black; background: white;"> 
Single license allows one developer to use Alvas.Audio. If You have more 
developers in the project You need to purchase additional licenses. For 
example Team license is for 4 developers.
Any kind of license gives You Royalty-Free redistribution rights with your 
applications.
</div> 
</a><br><a href="#questions" class="standardsButton"><font color="#ffffff"> 
		Up
		</font></a></td></tr><tr><td><a name="tip21"><h2>21. How do I stop (not pause) audio that's allready playing in command?</h2> 
<div style="font-family: Courier New; font-size: 10pt; color: black; background: white;"> 
Please use playerEx.ClosePlayer() method.
</div> 
</a><br><a href="#questions" class="standardsButton"><font color="#ffffff"> 
		Up
		</font></a></td></tr><tr><td><a name="tip22"><h2>22. I would like to use your audio control for VoIP. Record to memory (Speex)
and send the data by UDP the receive from UDP and playback raw data.
Would your control be suitable for this purpose?</h2> 
<div style="font-family: Courier New; font-size: 10pt; color: black; background: white;"> 
Yes, of course. You need:<br/> 
1. Download Speex Voice ACM Codec <a target=_blank href=http://www.free-codecs.com/download/Speex_Voice_ACM_Codec.htm>(http://www.free-codecs.com/download/Speex_Voice_ACM_Codec.htm)</a> to enable
Speex voice compression in Your apps.<br/> 
2. Develop Your UDP application.
</div> 
</a><br><a href="#questions" class="standardsButton"><font color="#ffffff"> 
		Up
		</font></a></td></tr><tr><td><a name="tip23"><h2>23. Using either the WaveReader or Player(Ex) classes,
is there anyway for me to tell how long (in seconds) a WAV file is?</h2> 
<div style="font-family: Courier New; font-size: 10pt; color: black; background: white;"> 
Look at WaveReader.GetDurationInMS.
</div> 
</a><br><a href="#questions" class="standardsButton"><font color="#ffffff"> 
		Up
		</font></a></td></tr><tr><td><a name="tip24"><h2>24. I'm looking for a way via a web page to convert a saved Wav file to MP3.  Will your code allow me to do 
so?</h2> 
<div style="font-family: Courier New; font-size: 10pt; color: black; background: white;"> 
<div class=code> 
<p style="margin: 0px;"><span style="color: blue;">using</span> System;</p> 
<p style="margin: 0px;"><span style="color: blue;">using</span> System.Data;</p> 
<p style="margin: 0px;"><span style="color: blue;">using</span> System.Configuration;</p> 
<p style="margin: 0px;"><span style="color: blue;">using</span> System.Web;</p> 
<p style="margin: 0px;"><span style="color: blue;">using</span> System.Web.Security;</p> 
<p style="margin: 0px;"><span style="color: blue;">using</span> System.Web.UI;</p> 
<p style="margin: 0px;"><span style="color: blue;">using</span> System.Web.UI.WebControls;</p> 
<p style="margin: 0px;"><span style="color: blue;">using</span> System.Web.UI.WebControls.WebParts;</p> 
<p style="margin: 0px;"><span style="color: blue;">using</span> System.Web.UI.HtmlControls;</p> 
<p style="margin: 0px;"><span style="color: blue;">using</span> Alvas.Audio;</p> 
<p style="margin: 0px;"><span style="color: blue;">using</span> System.IO;</p> 
<p style="margin: 0px;">&nbsp;</p> 
<p style="margin: 0px;"><span style="color: blue;">public</span> <span style="color: blue;">partial</span> <span style="color: blue;">class</span> <span style="color: teal;">_Default</span> : System.Web.UI.<span style="color: teal;">Page</span></p> 
<p style="margin: 0px;">{</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; <span style="color: blue;">protected</span> <span style="color: blue;">void</span> Page_Load(<span style="color: blue;">object</span> sender, <span style="color: teal;">EventArgs</span> e)</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; {</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; ConvertAudio();</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; }</p> 
<p style="margin: 0px;">&nbsp;</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; <span style="color: blue;">private</span> <span style="color: blue;">void</span> ConvertAudio()</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; {</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">string</span> webFile = <span style="color: maroon;">@"D:\AudioCS\bin\Debug\_web.mp3"</span>;</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">string</span> pcmFile = <span style="color: maroon;">@"D:\AudioCS\bin\Debug\_AudioCS.wav"</span>;</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">using</span> (<span style="color: teal;">WaveReader</span> wr = <span style="color: blue;">new</span> <span style="color: teal;">WaveReader</span>(<span style="color: teal;">File</span>.OpenRead(pcmFile)))</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: teal;">IntPtr</span> pcmFormat = wr.ReadFormat();</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">byte</span>[] pcmData = wr.ReadData();</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: teal;">IntPtr</span> webFormat = <span style="color: teal;">AudioCompressionManager</span>.GetCompatibleFormat(pcmFormat,</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: teal;">AudioCompressionManager</span>.MpegLayer3FormatTag);</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">byte</span>[] webData = <span style="color: teal;">AudioCompressionManager</span>.Convert(pcmFormat, webFormat,</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; pcmData, <span style="color: blue;">false</span>);</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: teal;">MemoryStream</span> ms = <span style="color: blue;">new</span> <span style="color: teal;">MemoryStream</span>();</p> 
<p style="margin: 0px;">&nbsp;</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">using</span> (<span style="color: teal;">WaveWriter</span> ww = <span style="color: blue;">new</span> <span style="color: teal;">WaveWriter</span>(ms,</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: teal;">AudioCompressionManager</span>.FormatBytes(webFormat)))</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; ww.WriteData(webData);</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">using</span> (<span style="color: teal;">WaveReader</span> wr2 = <span style="color: blue;">new</span> <span style="color: teal;">WaveReader</span>(ms))</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">using</span> (<span style="color: teal;">FileStream</span> fs = <span style="color: teal;">File</span>.OpenWrite(webFile))</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; wr2.MakeMP3(fs);</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; }</p> 
<p style="margin: 0px;">}</p> 
</div> 
</div> 
</a><br><a href="#questions" class="standardsButton"><font color="#ffffff"> 
		Up
		</font></a></td></tr><tr><td><a name="tip25"><h2>25. I just need to get the duration in MS for a file.  This code will be on an 
ASP.NET website, so I want to instance your class, assign a file name (NOT 
PLAY THE FILE) and then just get the duration.
 
Is this possible with your Alvas.Audio classes - if so, which class does it?</h2> 
<div style="font-family: Courier New; font-size: 10pt; color: black; background: white;"> 
Yes. Please use<br/><br/> 
<div class=code> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">string</span> path = <span style="color: maroon;">@"c:\test.wav"</span>;</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: teal;">WaveReader</span> wr = <span style="color: blue;">new</span> <span style="color: teal;">WaveReader</span>(<span style="color: teal;">File</span>.OpenRead(path));</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">int</span> durationInMS = wr.GetDurationInMS();</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; wr.Close();</p> 
</div> 
</div> 
</a><br><a href="#questions" class="standardsButton"><font color="#ffffff"> 
		Up
		</font></a></td></tr><tr><td><a name="tip26"><h2>26. I am developing an application in VB.net 2.0, and i am looking for a library 
to transform u-law audio files into mp3. Could I get some sample 
code to help me get this to work?</h2> 
<div style="font-family: Courier New; font-size: 10pt; color: black; background: white;"> 
<div class=code> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">Private</span> <span style="color: blue;">Sub</span> btnConvert_Click(<span style="color: blue;">ByVal</span> sender <span style="color: blue;">As</span> System.Object, <span style="color: blue;">ByVal</span> e <span style="color: blue;">As</span> System.EventArgs) <span style="color: blue;">Handles</span> btnConvert.Click</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">Dim</span> inFile <span style="color: blue;">As</span> <span style="color: blue;">String</span> = <span style="color: maroon;">"path_to_your_file.wav"</span></p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">Dim</span> outFile <span style="color: blue;">As</span> <span style="color: blue;">String</span> = <span style="color: maroon;">"path_to_output_file.mp3"</span></p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; Convert(inFile, outFile)</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">End</span> <span style="color: blue;">Sub</span></p> 
<p style="margin: 0px;">&nbsp;</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">Public</span> <span style="color: blue;">Sub</span> Convert(<span style="color: blue;">ByVal</span> inFile <span style="color: blue;">As</span> <span style="color: blue;">String</span>, <span style="color: blue;">ByVal</span> outFile <span style="color: blue;">As</span> <span style="color: blue;">String</span>)</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">Dim</span> inFs <span style="color: blue;">As</span> FileStream = File.OpenRead(inFile)</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">Dim</span> wr <span style="color: blue;">As</span> WaveReader = <span style="color: blue;">New</span> WaveReader(inFs)</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">Dim</span> inFormat <span style="color: blue;">As</span> IntPtr = wr.ReadFormat()</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">Dim</span> inData <span style="color: blue;">As</span> <span style="color: blue;">Byte</span>() = wr.ReadData</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">Dim</span> pcmFormat <span style="color: blue;">As</span> IntPtr = AudioCompressionManager.GetCompatibleFormat(inFormat, AudioCompressionManager.PcmFormatTag)</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">Dim</span> pcmData <span style="color: blue;">As</span> <span style="color: blue;">Byte</span>() = AudioCompressionManager.Convert(inFormat, pcmFormat, inData, <span style="color: blue;">False</span>)</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">Dim</span> mp3Format <span style="color: blue;">As</span> IntPtr = AudioCompressionManager.GetCompatibleFormat(pcmFormat, AudioCompressionManager.MpegLayer3FormatTag)</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">Dim</span> mp3Data <span style="color: blue;">As</span> <span style="color: blue;">Byte</span>() = AudioCompressionManager.Convert(pcmFormat, mp3Format, pcmData, <span style="color: blue;">False</span>)</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">Dim</span> outFs <span style="color: blue;">As</span> MemoryStream = <span style="color: blue;">New</span> MemoryStream()</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">Dim</span> ww <span style="color: blue;">As</span> WaveWriter = <span style="color: blue;">New</span> WaveWriter(outFs, AudioCompressionManager.FormatBytes(mp3Format))</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; ww.WriteData(mp3Data)</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">Dim</span> outWr <span style="color: blue;">As</span> WaveReader = <span style="color: blue;">New</span> WaveReader(outFs)</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; outWr.MakeMP3(File.Create(outFile))</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; ww.Close()</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">End</span> <span style="color: blue;">Sub</span></p> 
</div> 
</div> 
</a><br><a href="#questions" class="standardsButton"><font color="#ffffff"> 
		Up
		</font></a></td></tr><tr><td><a name="tip27"><h2>27. Is it possible to default to a particular format on any machine (e.g.  'MP3,
20kbps, 11,025Hz, mono') without  the user having to specify it?  I need to
default to a low quality mp3 format for speech recording and I don't want
the user to have to select anything. I want to make it as simple as possible
for them.  Is it reliable to just iterate through the FormatTags and select
the right one based on matching a string? Or will different client machines
have different values/indexes for these tags?</h2> 
<div style="font-family: Courier New; font-size: 10pt; color: black; background: white;"> 
<div class=code> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: green;">//---</span></p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">private</span> <span style="color: blue;">static</span> <span style="color: teal;">IntPtr</span> GetFormat()</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: teal;">WaveFormat</span> wf = <span style="color: blue;">new</span> <span style="color: teal;">WaveFormat</span>();</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; wf.wFormatTag = <span style="color: teal;">AudioCompressionManager</span>.MpegLayer3FormatTag;</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; wf.nChannels = 1;</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; wf.nSamplesPerSec = 11025;</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: teal;">FormatDetails</span>[] fdArr = <span style="color: teal;">AudioCompressionManager</span>.GetFormatList(wf);</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">foreach</span> (<span style="color: teal;">FormatDetails</span> fd <span style="color: blue;">in</span> fdArr)</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: teal;">WaveFormat</span> fdWf = <span style="color: teal;">AudioCompressionManager</span>.GetWaveFormat(fd.FormatHandle);</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">if</span> (fdWf.nAvgBytesPerSec * 8 == 20000)</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">return</span> fd.FormatHandle;</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">return</span> <span style="color: teal;">IntPtr</span>.Zero;</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }</p> 
</div> 
</div> 
</a><br><a href="#questions" class="standardsButton"><font color="#ffffff"> 
		Up
		</font></a></td></tr><tr><td><a name="tip28"><h2>28. I need to be able to convert from ADPCM 6khz 4-bit mono, ADPCM 8khz 4-bit mono, PCM8 8khz 8-but uLaw mono formats and 
standard formats such as WAV.</h2> 
<div style="font-family: Courier New; font-size: 10pt; color: black; background: white;"> 
Please see the code below for converting Your three sample audio files.<br/><br/> 
<div class=code> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; Vox2Pcm(<span style="color: maroon;">@"C:\AlvasAudio\8000.vox"</span>, <span style="color: maroon;">@"C:\AlvasAudio\8000.wav"</span>, 8000);</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; Vox2Pcm(<span style="color: maroon;">@"C:\AlvasAudio\6000.vox"</span>, <span style="color: maroon;">@"C:\AlvasAudio\6000.wav"</span>, 6000);</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; uLaw(<span style="color: maroon;">@"C:\AlvasAudio\8000.pcm"</span>, <span style="color: maroon;">@"C:\AlvasAudio\8000.pcm.wav"</span>);</p> 
<p style="margin: 0px;">&nbsp;</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: green;">//-------</span></p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">private</span> <span style="color: blue;">static</span> <span style="color: blue;">void</span> uLaw(<span style="color: blue;">string</span> inFile, <span style="color: blue;">string</span> outFile)</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: teal;">WaveFormat</span> wf = <span style="color: blue;">new</span> <span style="color: teal;">WaveFormat</span>();</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; wf.nChannels = 1;</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; wf.nSamplesPerSec = 8000;</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; wf.wFormatTag = <span style="color: teal;">AudioCompressionManager</span>.MuLawFormatTag;</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: teal;">FormatDetails</span>[] fdArr = <span style="color: teal;">AudioCompressionManager</span>.GetFormatList(wf);</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: teal;">IntPtr</span> format = fdArr[0].FormatHandle;</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: teal;">RawReader</span> br = <span style="color: blue;">new</span> <span style="color: teal;">RawReader</span>(<span style="color: teal;">File</span>.OpenRead(inFile), format);</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">byte</span>[] data = br.ReadData();</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; br.Close();</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: teal;">WaveWriter</span> ww = <span style="color: blue;">new</span> <span style="color: teal;">WaveWriter</span>(<span style="color: teal;">File</span>.Create(outFile),</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: teal;">AudioCompressionManager</span>.FormatBytes(format));</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; ww.WriteData(data);</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; ww.Close();</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }</p> 
<p style="margin: 0px;">&nbsp;</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">private</span> <span style="color: blue;">static</span> <span style="color: blue;">void</span> Vox2Pcm(<span style="color: blue;">string</span> inFile, <span style="color: blue;">string</span> outFile, <span style="color: blue;">int</span> samplesPerSec)</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: teal;">BinaryReader</span> br = <span style="color: blue;">new</span> <span style="color: teal;">BinaryReader</span>(<span style="color: teal;">File</span>.OpenRead(inFile));</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: teal;">IntPtr</span> format = <span style="color: teal;">AudioCompressionManager</span>.GetPcmFormat(1, 16, samplesPerSec);</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: teal;">WaveWriter</span> ww = <span style="color: blue;">new</span> <span style="color: teal;">WaveWriter</span>(<span style="color: teal;">File</span>.Create(outFile),</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: teal;">AudioCompressionManager</span>.FormatBytes(format));</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: teal;">Vox</span>.Vox2Wav(br, ww);</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; br.Close();</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; ww.Close();</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }</p> 
</div> 
</div> 
</a><br><a href="#questions" class="standardsButton"><font color="#ffffff"> 
		Up
		</font></a></td></tr><tr><td><a name="tip29"><h2>29. Must I pay a license for every deploy on my customer or only one for developer?</h2> 
<div style="font-family: Courier New; font-size: 10pt; color: black; background: white;"> 
You must pay a license for every developer in your team.
</div> 
</a><br><a href="#questions" class="standardsButton"><font color="#ffffff"> 
		Up
		</font></a></td></tr><tr><td><a name="tip30"><h2>30. Reading / Writing of our VOX Files is not possibile.</h2> 
<div style="font-family: Courier New; font-size: 10pt; color: black; background: white;"> 
Alvas.Audio now supports Dialogic Vox files. Please download new version 
<a href=http://www.alvas.net/Download/Alvas.Audio.zip>http://www.alvas.net/Download/Alvas.Audio.zip</a> and see AudioExCS sample.
</div> 
</a><br><a href="#questions" class="standardsButton"><font color="#ffffff"> 
		Up
		</font></a></td></tr><tr><td><a name="tip31"><h2>31. Can you convert WAV files to the headerless formats like Dialogic VOX and PCM 8khz?</h2> 
<div style="font-family: Courier New; font-size: 10pt; color: black; background: white;"> 
Please see code for Wav2Vox with resample<br/><br/> 
<div class=code> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; Wav2Vox(<span style="color: maroon;">@"C:\AlvasAudio\6000.wav"</span>, <span style="color: maroon;">@"C:\AlvasAudio\6000.wav.vox"</span>, 8000);</p> 
<p style="margin: 0px;">&nbsp;</p> 
<p style="margin: 0px;">&nbsp;</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">private</span> <span style="color: blue;">static</span> <span style="color: blue;">void</span> Wav2Vox(<span style="color: blue;">string</span> inFile, <span style="color: blue;">string</span> outFile, <span style="color: blue;">int</span> samplesPerSec)</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: teal;">WaveReader</span> wr = <span style="color: blue;">new</span> <span style="color: teal;">WaveReader</span>(<span style="color: teal;">File</span>.OpenRead(inFile));</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: teal;">IntPtr</span> format = wr.ReadFormat();</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">byte</span>[] data = wr.ReadData();</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; wr.Close();</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: teal;">WaveFormat</span> wf = <span style="color: teal;">AudioCompressionManager</span>.GetWaveFormat(format);</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">if</span> (wf.wFormatTag != <span style="color: teal;">AudioCompressionManager</span>.PcmFormatTag)<span style="color: green;">//Decode if not PCM data</span></p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; Decode2Pcm(<span style="color: blue;">ref</span> format, <span style="color: blue;">ref</span> data, <span style="color: blue;">ref</span> wf);</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">if</span> (wf.nSamplesPerSec != samplesPerSec)</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; Resample(<span style="color: blue;">ref</span> format, <span style="color: blue;">ref</span> data, <span style="color: blue;">ref</span> wf, samplesPerSec);</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: teal;">BinaryWriter</span> bw = <span style="color: blue;">new</span> <span style="color: teal;">BinaryWriter</span>(<span style="color: teal;">File</span>.OpenWrite(outFile));</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: teal;">BinaryReader</span> br = <span style="color: blue;">new</span> <span style="color: teal;">BinaryReader</span>(<span style="color: blue;">new</span> <span style="color: teal;">MemoryStream</span>(data));</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: teal;">Vox</span>.Raw2Vox(br, bw, wf.wBitsPerSample);</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; br.Close();</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; bw.Close();</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }</p> 
<p style="margin: 0px;">&nbsp;</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">private</span> <span style="color: blue;">static</span> <span style="color: blue;">void</span> Resample(<span style="color: blue;">ref</span> <span style="color: teal;">IntPtr</span> format, <span style="color: blue;">ref</span> <span style="color: blue;">byte</span>[] data, <span style="color: blue;">ref</span> <span style="color: teal;">WaveFormat</span> wf,</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">int</span> samplesPerSec)</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">foreach</span> (<span style="color: teal;">FormatDetails</span> fd <span style="color: blue;">in</span></p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: teal;">AudioCompressionManager</span>.GetCompatibleFormatList(format))</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">if</span> (fd.FormatTag == <span style="color: teal;">AudioCompressionManager</span>.PcmFormatTag)</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: teal;">WaveFormat</span> wfFd = <span style="color: teal;">AudioCompressionManager</span>.GetWaveFormat(fd.FormatHandle);</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">if</span> (wf.wBitsPerSample == wfFd.wBitsPerSample &amp;&amp; wf.nChannels ==</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; wfFd.nChannels &amp;&amp; wfFd.nSamplesPerSec == samplesPerSec)</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">byte</span>[] buffer = <span style="color: teal;">AudioCompressionManager</span>.Convert(format, fd.FormatHandle, data, <span style="color: blue;">false</span>);</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; format = fd.FormatHandle;</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; data = buffer;</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; wf = wfFd;</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }</p> 
<p style="margin: 0px;">&nbsp;</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">private</span> <span style="color: blue;">static</span> <span style="color: blue;">void</span> Decode2Pcm(<span style="color: blue;">ref</span> <span style="color: teal;">IntPtr</span> format, <span style="color: blue;">ref</span> <span style="color: blue;">byte</span>[] data, <span style="color: blue;">ref</span> <span style="color: teal;">WaveFormat</span> wf)</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: teal;">IntPtr</span> newFormat = <span style="color: teal;">AudioCompressionManager</span>.GetCompatibleFormat(format,</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: teal;">AudioCompressionManager</span>.PcmFormatTag);</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">byte</span>[] buffer = <span style="color: teal;">AudioCompressionManager</span>.Convert(format, newFormat, data, <span style="color: blue;">false</span>);</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; wf = <span style="color: teal;">AudioCompressionManager</span>.GetWaveFormat(newFormat);</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; format = newFormat;</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; data = buffer;</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }</p> 
</div> 
</div> 
</a><br><a href="#questions" class="standardsButton"><font color="#ffffff"> 
		Up
		</font></a></td></tr><tr><td><a name="tip32"><h2>32. It can play from an array of doubles?</h2> 
<div style="font-family: Courier New; font-size: 10pt; color: black; background: white;"> 
<div class=code> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: teal;">PlayerEx</span> pl = <span style="color: blue;">new</span> <span style="color: teal;">PlayerEx</span>();</p> 
<p style="margin: 0px;">&nbsp;</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">private</span> <span style="color: blue;">static</span> <span style="color: blue;">void</span> PlayArray(<span style="color: teal;">PlayerEx</span> pl)</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">double</span> fs = 8000; <span style="color: green;">// sample freq</span></p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">double</span> freq = 1000; <span style="color: green;">// desired tone</span></p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">short</span>[] mySound = <span style="color: blue;">new</span> <span style="color: blue;">short</span>[4000];</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">for</span> (<span style="color: blue;">int</span> i = 0; i &lt; 4000; i++)</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">double</span> t = (<span style="color: blue;">double</span>)i / fs; <span style="color: green;">// current time</span></p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; mySound[i] = (<span style="color: blue;">short</span>)(<span style="color: teal;">Math</span>.Cos(t * freq) * (<span style="color: blue;">short</span>.MaxValue));</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: teal;">IntPtr</span> format = <span style="color: teal;">AudioCompressionManager</span>.GetPcmFormat(1, 16, (<span style="color: blue;">int</span>)fs);</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; pl.OpenPlayer(format);</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">byte</span>[] mySoundByte = <span style="color: blue;">new</span> <span style="color: blue;">byte</span>[mySound.Length * 2];</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: teal;">Buffer</span>.BlockCopy(mySound, 0, mySoundByte, 0, mySoundByte.Length);</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; pl.AddData(mySoundByte);</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; pl.StartPlay();</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }</p> 
</div> 
</div> 
</a><br><a href="#questions" class="standardsButton"><font color="#ffffff"> 
		Up
		</font></a></td></tr><tr><td><a name="tip33"><h2>33. I was evaluating your product to use in an application for Asterisk(VOIP) 
solution, but I found there is no output support for SLINEAR. Do you plan to 
support this format? This would be a great option since there is no Windows 
application to make the conversion for Asterisk.</h2> 
<div style="font-family: Courier New; font-size: 10pt; color: black; background: white;"> 
Alvas.Audio supports SLINEAR files. See code below.<br/><br/> 
<div class=code> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; Wav2Sln(<span style="color: maroon;">@"C:\AlvasAudio\obrigada.wav"</span>, <span style="color: maroon;">@"C:\AlvasAudio\obrigada.sln"</span>);</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: green;">//---</span></p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">private</span> <span style="color: blue;">static</span> <span style="color: blue;">void</span> Wav2Sln(<span style="color: blue;">string</span> inFile, <span style="color: blue;">string</span> outFile)</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: teal;">IntPtr</span> newFormat = <span style="color: teal;">AudioCompressionManager</span>.GetPcmFormat(1, 16, 8000);</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: teal;">WaveReader</span> wr = <span style="color: blue;">new</span> <span style="color: teal;">WaveReader</span>(<span style="color: teal;">File</span>.OpenRead(inFile));</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: teal;">IntPtr</span> oldFormat = wr.ReadFormat();</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">byte</span>[] data = wr.ReadData();</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; wr.Close();</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">byte</span>[] buffer = <span style="color: teal;">AudioCompressionManager</span>.Convert(oldFormat, newFormat, data, <span style="color: blue;">false</span>);</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">using</span> (<span style="color: teal;">RawWriter</span> bw = <span style="color: blue;">new</span> <span style="color: teal;">RawWriter</span>(<span style="color: teal;">File</span>.Create(outFile)))</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; bw.WriteData(buffer);</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }</p> 
</div> 
</div> 
</a><br><a href="#questions" class="standardsButton"><font color="#ffffff"> 
		Up
		</font></a></td></tr><tr><td><a name="tip34"><h2>34. How to convert a wave file into an raw alaw 8Khz mono file?</h2> 
<div style="font-family: Courier New; font-size: 10pt; color: black; background: white;"> 
<div class=code> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">string</span> pcmFile = <span style="color: maroon;">@"C:\AlvasAudio\obrigada.wav"</span>;</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">string</span> alawFile = <span style="color: maroon;">@"C:\AlvasAudio\obrigada.alaw"</span>;</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; Pcm2ALaw(pcmFile, alawFile);</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: green;">//---</span></p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">private</span> <span style="color: blue;">static</span> <span style="color: blue;">void</span> Pcm2ALaw(<span style="color: blue;">string</span> wavFile, <span style="color: blue;">string</span> alawFile)</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: teal;">WaveReader</span> wr = <span style="color: blue;">new</span> <span style="color: teal;">WaveReader</span>(<span style="color: teal;">File</span>.OpenRead(wavFile));</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: teal;">IntPtr</span> format = wr.ReadFormat();</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">byte</span>[] data = wr.ReadData();</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; wr.Close();</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: teal;">WaveFormat</span> wfAlaw = <span style="color: blue;">new</span> <span style="color: teal;">WaveFormat</span>();</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; wfAlaw.wFormatTag = <span style="color: teal;">AudioCompressionManager</span>.ALawFormatTag;</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; wfAlaw.nChannels = 1;</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; wfAlaw.nSamplesPerSec = 8000;</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: teal;">FormatDetails</span>[] fdArr = <span style="color: teal;">AudioCompressionManager</span>.GetFormatList(wfAlaw);</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: teal;">WaveFormat</span> wf = <span style="color: teal;">AudioCompressionManager</span>.GetWaveFormat(format);</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">if</span> (wf.wFormatTag != <span style="color: teal;">AudioCompressionManager</span>.PcmFormatTag)<span style="color: green;">//Decode if not PCM data </span></p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; Decode2Pcm(<span style="color: blue;">ref</span> format, <span style="color: blue;">ref</span> data, <span style="color: blue;">ref</span> wf);</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">if</span> (wf.nSamplesPerSec != wfAlaw.nSamplesPerSec || wf.nChannels != wfAlaw.nChannels)</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; Resample(<span style="color: blue;">ref</span> format, <span style="color: blue;">ref</span> data, <span style="color: blue;">ref</span> wf, wfAlaw.nSamplesPerSec, wfAlaw.nChannels);</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }</p> 
<p style="margin: 0px;">&nbsp;</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">byte</span>[] buffer = <span style="color: teal;">AudioCompressionManager</span>.Convert(format, fdArr[0].FormatHandle, data, <span style="color: blue;">false</span>);</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: teal;">RawWriter</span> bw = <span style="color: blue;">new</span> <span style="color: teal;">RawWriter</span>(<span style="color: teal;">File</span>.Create(alawFile));</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; bw.WriteData(buffer);</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; bw.Close();</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }</p> 
<p style="margin: 0px;">&nbsp;</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">private</span> <span style="color: blue;">static</span> <span style="color: blue;">void</span> Resample(<span style="color: blue;">ref</span> <span style="color: teal;">IntPtr</span> format, <span style="color: blue;">ref</span> <span style="color: blue;">byte</span>[] data, <span style="color: blue;">ref</span> <span style="color: teal;">WaveFormat</span> wf, <span style="color: blue;">int</span> samplesPerSec, <span style="color: blue;">short</span> channels)</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: teal;">IntPtr</span> newFormat = <span style="color: teal;">AudioCompressionManager</span>.GetPcmFormat(channels, wf.wBitsPerSample, samplesPerSec);</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">byte</span>[] buffer = <span style="color: teal;">AudioCompressionManager</span>.Convert(format, newFormat, data, <span style="color: blue;">true</span>);</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; format = newFormat;</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; wf = <span style="color: teal;">AudioCompressionManager</span>.GetWaveFormat(newFormat);</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; data = buffer;</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }</p> 
<p style="margin: 0px;">&nbsp;</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">private</span> <span style="color: blue;">static</span> <span style="color: blue;">void</span> Decode2Pcm(<span style="color: blue;">ref</span> <span style="color: teal;">IntPtr</span> format, <span style="color: blue;">ref</span> <span style="color: blue;">byte</span>[] data, <span style="color: blue;">ref</span> <span style="color: teal;">WaveFormat</span> wf)</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: teal;">IntPtr</span> newFormat = <span style="color: teal;">AudioCompressionManager</span>.GetCompatibleFormat(format,</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: teal;">AudioCompressionManager</span>.PcmFormatTag);</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">byte</span>[] buffer = <span style="color: teal;">AudioCompressionManager</span>.Convert(format, newFormat, data, <span style="color: blue;">false</span>);</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; wf = <span style="color: teal;">AudioCompressionManager</span>.GetWaveFormat(newFormat);</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; format = newFormat;</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; data = buffer;</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }</p> 
</div> 
</div> 
</a><br><a href="#questions" class="standardsButton"><font color="#ffffff"> 
		Up
		</font></a></td></tr><tr><td><a name="tip35"><h2>35. We need to be able to essentially convert a wav file while adjusting its speed by a factor.</h2> 
<div style="font-family: Courier New; font-size: 10pt; color: black; background: white;"> 
<div class=code> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; ChangeSpeed(<span style="color: maroon;">@"g:\AlvasAudio\obrigada.wav"</span>, <span style="color: maroon;">@"g:\AlvasAudio\obrigada1.wav"</span>, 50);<span style="color: green;">//two times as quickly</span></p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; ChangeSpeed(<span style="color: maroon;">@"g:\AlvasAudio\obrigada.wav"</span>, <span style="color: maroon;">@"g:\AlvasAudio\obrigada2.wav"</span>, 200);<span style="color: green;">//two times as slowly</span></p> 
<p style="margin: 0px;">&nbsp;</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">public</span> <span style="color: blue;">static</span> <span style="color: blue;">void</span> ChangeSpeed(<span style="color: blue;">string</span> inFile, <span style="color: blue;">string</span> outFile, <span style="color: blue;">int</span> persent)</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">if</span> (persent &lt; 1)</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">throw</span> <span style="color: blue;">new</span> <span style="color: teal;">ArgumentOutOfRangeException</span>(<span style="color: maroon;">"persent"</span>);</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; WaveReader wr = <span style="color: blue;">new</span> WaveReader(<span style="color: teal;">File</span>.OpenRead(inFile));</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: teal;">IntPtr</span> inFormat = wr.ReadFormat();</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">byte</span>[] data = wr.ReadData();</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; wr.Close();</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; WaveWriter ww = <span style="color: blue;">new</span> WaveWriter(<span style="color: teal;">File</span>.Create(outFile), AudioCompressionManager.FormatBytes(inFormat));</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; WaveFormat wf = AudioCompressionManager.GetWaveFormat(inFormat);</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; WaveFormat wfPrev = wf;</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">if</span> (wf.wFormatTag != AudioCompressionManager.PcmFormatTag)<span style="color: green;">//Decode if not PCM da</span></p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; Decode2Pcm(<span style="color: blue;">ref</span> inFormat, <span style="color: blue;">ref</span> data, <span style="color: blue;">ref</span> wf);</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">int</span> samplesPerSecond = wf.nSamplesPerSec * persent / 100;</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: teal;">IntPtr</span> pcmFormat = AudioCompressionManager.GetPcmFormat(wf.nChannels, wf.wBitsPerSample, samplesPerSecond);</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">byte</span>[] buffer = AudioCompressionManager.Convert(inFormat, pcmFormat, data, <span style="color: blue;">false</span>);</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">if</span> (!wfPrev.Equals(wf))</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; buffer = AudioCompressionManager.Convert(inFormat, ww.GetFormat(), buffer, <span style="color: blue;">false</span>);</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; ww.WriteData(buffer);</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; ww.Close();</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }</p> 
</div> 
</div> 
</a><br><a href="#questions" class="standardsButton"><font color="#ffffff"> 
		Up
		</font></a></td></tr><tr><td><a name="tip36"><h2>36. Does the Alvas.Audio library work with Terminal Services?</h2> 
<div style="font-family: Courier New; font-size: 10pt; color: black; background: white;"> 
Due to the way audio drivers/codecs are remapped using TS with Windows 2000, the library will not work through TS when connecting to a Windows 2000 Server.  It works fine from the console. 
</div> 
</a><br><a href="#questions" class="standardsButton"><font color="#ffffff"> 
		Up
		</font></a></td></tr><tr><td><a name="tip37"><h2>37. How to send audio stream in the browser?</h2> 
<div class=code> 
<div style="font-family: Courier New; font-size: 10pt; color: black; background: white;"> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; <span style="color: blue;">public</span> <span style="color: blue;">static</span> <span style="color: blue;">void</span> ResponseAudioStream(<span style="color: teal;">HttpResponse</span> Response, <span style="color: blue;">string</span> voxFile, <span style="color: blue;">int</span> samplesPerSec)</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; {</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: teal;">BinaryReader</span> br = <span style="color: blue;">new</span> <span style="color: teal;">BinaryReader</span>(<span style="color: teal;">File</span>.OpenRead(voxFile));</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: teal;">MemoryStream</span> pcmStream = <span style="color: blue;">new</span> <span style="color: teal;">MemoryStream</span>();</p> 
<p style="margin: 0px;">&nbsp;</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: teal;">IntPtr</span> pcmFormat = <span style="color: teal;">AudioCompressionManager</span>.GetPcmFormat(1, 16, samplesPerSec);</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: teal;">WaveWriter</span> ww = <span style="color: blue;">new</span> <span style="color: teal;">WaveWriter</span>(pcmStream, <span style="color: teal;">AudioCompressionManager</span>.FormatBytes(pcmFormat));</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: teal;">Vox</span>.Vox2Wav(br, ww);</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: teal;">WaveReader</span> wr = <span style="color: blue;">new</span> <span style="color: teal;">WaveReader</span>(pcmStream);</p> 
<p style="margin: 0px;">&nbsp;</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">byte</span>[] pcmData = pcmStream.ToArray();</p> 
<p style="margin: 0px;">&nbsp;</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; br.Close();</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; ww.Close();</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; wr.Close();</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; pcmStream.Close();</p> 
<p style="margin: 0px;">&nbsp;</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; Response.ContentType = <span style="color: maroon;">"audio/x-wav"</span>;</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; Response.BinaryWrite(pcmData);</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; Response.End();</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; }</p> 
</div> 
</div> 
</a><br><a href="#questions" class="standardsButton"><font color="#ffffff"> 
		Up
		</font></a></td></tr><tr><td><a name="tip38"><h2>38. How to Play big audio files?</h2> 
<div class=code> 
<div style="font-family: Courier New; font-size: 10pt; color: black; background: white;"> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">private</span> <span style="color: blue;">void</span> btnPlay_Click(<span style="color: blue;">object</span> sender, <span style="color: teal;">EventArgs</span> e)</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; StartPlay(<span style="color: teal;">File</span>.OpenRead(<span style="color: maroon;">@"c:\audio\big.wav"</span>));</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }</p> 
<p style="margin: 0px;">&nbsp;</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">public</span> MainForm()</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; InitializeComponent();</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; playEx.Done += <span style="color: blue;">new</span> PlayerEx.DoneEventHandler(playEx_Done);</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }</p> 
<p style="margin: 0px;">&nbsp;</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">void</span> playEx_Done(<span style="color: blue;">object</span> sender, DoneEventArgs e)</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; ReadData();</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }</p> 
<p style="margin: 0px;">&nbsp;</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">private</span> PlayerEx playEx = <span style="color: blue;">new</span> PlayerEx();</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">private</span> WaveReader wr = <span style="color: blue;">null</span>;</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">private</span> <span style="color: blue;">int</span> pos = 0;</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">private</span> <span style="color: blue;">int</span> seconds = 5;</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">private</span> <span style="color: blue;">int</span> len = 0;</p> 
<p style="margin: 0px;">&nbsp;</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">public</span> <span style="color: blue;">void</span> StartPlay(<span style="color: teal;">Stream</span> _stream)</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">if</span> (playEx.State == DeviceState.Paused)</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; playEx.ResumePlay();</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">else</span></p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; pos = 0;</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; wr = <span style="color: blue;">new</span> WaveReader(_stream);</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; len = wr.GetDurationInMS() / 1000;</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: teal;">IntPtr</span> format = wr.ReadFormat();</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; playEx.OpenPlayer(format);</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; ReadData();</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; playEx.StartPlay();</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }</p> 
<p style="margin: 0px;">&nbsp;</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">private</span> <span style="color: blue;">void</span> ReadData()</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">if</span> (pos &lt;= len)</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">byte</span>[] data = wr.ReadData(pos, seconds);</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; pos += seconds;</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; playEx.AddData(data);</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }</p> 
</div> 
</div> 
</a><br><a href="#questions" class="standardsButton"><font color="#ffffff"> 
		Up
		</font></a></td></tr><tr><td><a name="tip39"><h2>39. Simple RecorderEx example</h2> 
<div class=code> 
<div style="font-family: Courier New; font-size: 10pt; color: black; background: white;"> 
<p style="margin: 0px;"><span style="color: blue;">using</span> System;</p> 
<p style="margin: 0px;"><span style="color: blue;">using</span> System.Windows.Forms;</p> 
<p style="margin: 0px;"><span style="color: blue;">using</span> Alvas.Audio;</p> 
<p style="margin: 0px;"><span style="color: blue;">using</span> System.IO;</p> 
<p style="margin: 0px;">&nbsp;</p> 
<p style="margin: 0px;"><span style="color: blue;">namespace</span> SimpleRecorder</p> 
<p style="margin: 0px;">{</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; <span style="color: blue;">public</span> <span style="color: blue;">partial</span> <span style="color: blue;">class</span> <span style="color: teal;">RecorderForm</span> : <span style="color: teal;">Form</span></p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; {</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">public</span> RecorderForm()</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; InitializeComponent();</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; Init();</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }</p> 
<p style="margin: 0px;">&nbsp;</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">private</span> <span style="color: blue;">void</span> Init()</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; btnStop.Enabled = <span style="color: blue;">false</span>;</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; rex = <span style="color: blue;">new</span> <span style="color: teal;">RecorderEx</span>();</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: teal;">IntPtr</span> pcmFormat = <span style="color: teal;">AudioCompressionManager</span>.GetPcmFormat(1, 16, 44100);</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; rex.Format = pcmFormat;<span style="color: green;">//AudioCompressionManager.GetCompatibleFormat(pcmFormat, AudioCompressionManager.Gsm610FormatTag);</span></p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; rex.Open += <span style="color: blue;">new</span> <span style="color: teal;">EventHandler</span>(rex_Open);</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; rex.Data += <span style="color: blue;">new</span> <span style="color: teal;">RecorderEx</span>.<span style="color: teal;">DataEventHandler</span>(rex_Data);</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; rex.Close += <span style="color: blue;">new</span> <span style="color: teal;">EventHandler</span>(rex_Close);</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }</p> 
<p style="margin: 0px;">&nbsp;</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">void</span> rex_Close(<span style="color: blue;">object</span> sender, <span style="color: teal;">EventArgs</span> e)</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; ww.Close();</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; ww = <span style="color: blue;">null</span>;</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }</p> 
<p style="margin: 0px;">&nbsp;</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">void</span> rex_Data(<span style="color: blue;">object</span> sender, <span style="color: teal;">DataEventArgs</span> e)</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; ww.WriteData(e.Data);</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }</p> 
<p style="margin: 0px;">&nbsp;</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">void</span> rex_Open(<span style="color: blue;">object</span> sender, <span style="color: teal;">EventArgs</span> e)</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">if</span> (ww != <span style="color: blue;">null</span>)</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; ww.Close();</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">string</span> fileName = <span style="color: teal;">Path</span>.ChangeExtension(<span style="color: teal;">Application</span>.ExecutablePath, <span style="color: maroon;">".wav"</span>);</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; ww = <span style="color: blue;">new</span> <span style="color: teal;">WaveWriter</span>(<span style="color: teal;">File</span>.Create(fileName), </p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: teal;">AudioCompressionManager</span>.FormatBytes(rex.Format));</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }</p> 
<p style="margin: 0px;">&nbsp;</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">private</span> <span style="color: teal;">RecorderEx</span> rex;</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">private</span> <span style="color: teal;">WaveWriter</span> ww;</p> 
<p style="margin: 0px;">&nbsp;</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">private</span> <span style="color: blue;">void</span> btnRec_Click(<span style="color: blue;">object</span> sender, <span style="color: teal;">EventArgs</span> e)</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; rex.StartRecord();</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; EnableButtons();</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }</p> 
<p style="margin: 0px;">&nbsp;</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">private</span> <span style="color: blue;">void</span> EnableButtons()</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; btnStop.Enabled = !btnStop.Enabled;</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; btnRec.Enabled = !btnRec.Enabled;</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }</p> 
<p style="margin: 0px;">&nbsp;</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">private</span> <span style="color: blue;">void</span> btnStop_Click(<span style="color: blue;">object</span> sender, <span style="color: teal;">EventArgs</span> e)</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; rex.StopRecord();</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; EnableButtons();</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; }</p> 
<p style="margin: 0px;">}</p> 
</div> 
</div> 
</a><br><a href="#questions" class="standardsButton"><font color="#ffffff"> 
		Up
		</font></a></td></tr><tr><td><a name="tip40"><h2>40. Simple PlayerEx example</h2> 
<div class=code> 
<div style="font-family: Courier New; font-size: 10pt; color: black; background: white;"> 
<p style="margin: 0px;"><span style="color: blue;">using</span> System;</p> 
<p style="margin: 0px;"><span style="color: blue;">using</span> System.Windows.Forms;</p> 
<p style="margin: 0px;"><span style="color: blue;">using</span> Alvas.Audio;</p> 
<p style="margin: 0px;"><span style="color: blue;">using</span> System.IO;</p> 
<p style="margin: 0px;">&nbsp;</p> 
<p style="margin: 0px;"><span style="color: blue;">namespace</span> SimpleRecorder</p> 
<p style="margin: 0px;">{</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; <span style="color: blue;">public</span> <span style="color: blue;">partial</span> <span style="color: blue;">class</span> <span style="color: teal;">PlayerForm</span> : <span style="color: teal;">Form</span></p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; {</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">public</span> PlayerForm()</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; InitializeComponent();</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }</p> 
<p style="margin: 0px;">&nbsp;</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">private</span> <span style="color: teal;">PlayerEx</span> plex = <span style="color: blue;">new</span> <span style="color: teal;">PlayerEx</span>();</p> 
<p style="margin: 0px;">&nbsp;</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">private</span> <span style="color: blue;">void</span> Play(<span style="color: blue;">string</span> fileName)</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">using</span> (<span style="color: teal;">WaveReader</span> wr = <span style="color: blue;">new</span> <span style="color: teal;">WaveReader</span>(<span style="color: teal;">File</span>.OpenRead(fileName)))</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: teal;">IntPtr</span> format = wr.ReadFormat();</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">byte</span>[] data = wr.ReadData();</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; plex.OpenPlayer(format);</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; plex.AddData(data);</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; plex.StartPlay();</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }</p> 
<p style="margin: 0px;">&nbsp;</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">private</span> <span style="color: blue;">void</span> btnPlay_Click(<span style="color: blue;">object</span> sender, <span style="color: teal;">EventArgs</span> e)</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; Play(<span style="color: maroon;">@"G:\AlvasAudio\gsm.wav"</span>);</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }</p> 
<p style="margin: 0px;">&nbsp;</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">private</span> <span style="color: blue;">void</span> btnStop_Click(<span style="color: blue;">object</span> sender, <span style="color: teal;">EventArgs</span> e)</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">if</span> (plex.State != <span style="color: teal;">DeviceState</span>.Closed)</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; plex.ClosePlayer();</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }</p> 
<p style="margin: 0px;">&nbsp;</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; }</p> 
<p style="margin: 0px;">}</p> 
</div> 
</div> 
</a><br><a href="#questions" class="standardsButton"><font color="#ffffff"> 
		Up
		</font></a></td></tr><tr><td><a name="tip41"><h2>41. Can you tell me whether the player will support playing Dialogic .vox (adpcm) format?</h2> 
<div class=code> 
<div style="font-family: Courier New; font-size: 10pt; color: black; background: white;"> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">private</span> <span style="color: teal;">PlayerEx</span> playEx = <span style="color: blue;">new</span> <span style="color: teal;">PlayerEx</span>();</p> 
<p style="margin: 0px;">&nbsp;</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">private</span> <span style="color: blue;">void</span> button1_Click(<span style="color: blue;">object</span> sender, <span style="color: teal;">EventArgs</span> e)</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: teal;">Stream</span> str = Vox2Wav(<span style="color: maroon;">@"c:\audio\8000.vox"</span>, 8000);</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: teal;">WaveReader</span> wr = <span style="color: blue;">new</span> <span style="color: teal;">WaveReader</span>(str);</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: teal;">IntPtr</span> format = wr.ReadFormat();</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">byte</span>[] data = wr.ReadData();</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; str.Close();</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; playEx.OpenPlayer(format);</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; playEx.AddData(data);</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; playEx.StartPlay();</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }</p> 
<p style="margin: 0px;">&nbsp;</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">private</span> <span style="color: blue;">static</span> <span style="color: teal;">Stream</span> Vox2Wav(<span style="color: blue;">string</span> voxFile, <span style="color: blue;">int</span> samplesPerSec)</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: teal;">BinaryReader</span> br = <span style="color: blue;">new</span> <span style="color: teal;">BinaryReader</span>(<span style="color: teal;">File</span>.OpenRead(voxFile));</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: teal;">IntPtr</span> format = <span style="color: teal;">AudioCompressionManager</span>.GetPcmFormat(1, 16, samplesPerSec);</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: teal;">MemoryStream</span> ms = <span style="color: blue;">new</span> <span style="color: teal;">MemoryStream</span>();</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: teal;">WaveWriter</span> ww = <span style="color: blue;">new</span> <span style="color: teal;">WaveWriter</span>(ms, <span style="color: teal;">AudioCompressionManager</span>.FormatBytes(format));</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: teal;">Vox</span>.Vox2Wav(br, ww);</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; br.Close();</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">return</span> ms;</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }</p> 
</div> 
</div> 
</a><br><a href="#questions" class="standardsButton"><font color="#ffffff"> 
		Up
		</font></a></td></tr><tr><td><a name="tip42"><h2>42. I expected that the RecorderEx.Data event would be raised whenever a buffer (size determined by BufferSize) was filled, but it's only raised on the half-second. Is there any way to reduce this?</h2> 
<div class=code> 
<div style="font-family: Courier New; font-size: 10pt; color: black; background: white;"> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; recEx.AutoSizeBuffer = <span style="color: blue;">false</span>;</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: teal;">WaveFormat</span> wf = <span style="color: teal;">AudioCompressionManager</span>.GetWaveFormat(recEx.Format);</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; recEx.BufferSize = <span style="color: teal;">AudioCompressionManager</span>.Milliseconds2Bytes(wf, 100);<span style="color: green;">//100 milliseconds</span></p> 
</div> 
</div> 
</a><br><a href="#questions" class="standardsButton"><font color="#ffffff"> 
		Up
		</font></a></td></tr><tr><td><a name="tip43"><h2>43. How do I Boost the volume of an existing WAVE file - How can I make it louder?</h2> 
<div class=code> 
<div style="font-family: Courier New; font-size: 10pt; color: black; background: white;"> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">private</span> <span style="color: blue;">static</span> <span style="color: blue;">void</span> ChangeVolume(<span style="color: blue;">string</span> inFile, <span style="color: blue;">string</span> outFile, <span style="color: blue;">int</span> persent)</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: teal;">Stream</span> inStream = <span style="color: teal;">File</span>.OpenRead(inFile);</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: teal;">Stream</span> outStream = <span style="color: teal;">File</span>.Create(outFile);</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: teal;">WaveReader</span> wr = <span style="color: blue;">new</span> <span style="color: teal;">WaveReader</span>(inStream);</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: teal;">IntPtr</span> format = wr.ReadFormat();</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">byte</span>[] data = wr.ReadData();</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; wr.Close();</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">byte</span>[] buffer = <span style="color: teal;">AudioCompressionManager</span>.ChangeVolume(format, data, persent);</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: teal;">WaveWriter</span> ww = <span style="color: blue;">new</span> <span style="color: teal;">WaveWriter</span>(outStream, <span style="color: teal;">AudioCompressionManager</span>.FormatBytes(format));</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; ww.WriteData(buffer);</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; ww.Close();</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }</p> 
</div> 
</div> 
</a><br><a href="#questions" class="standardsButton"><font color="#ffffff"> 
		Up
		</font></a></td></tr><tr><td><a name="tip44"><h2>44. Do you have any examples or sample applications that record directly to mp3?</h2> 
<div class=code> 
<div style="font-family: Courier New; font-size: 10pt; color: black; background: white;"> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">void</span> recEx_DataMp3(<span style="color: blue;">object</span> sender, <span style="color: teal;">DataEventArgs</span> e)</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; mw.WriteData(e.Data);</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }</p> 
<p style="margin: 0px;">&nbsp;</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">private</span> <span style="color: teal;">Mp3Writer</span> mw;</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: teal;">RecorderEx</span> recEx = <span style="color: blue;">new</span> <span style="color: teal;">RecorderEx</span>();</p> 
<p style="margin: 0px;">&nbsp;</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">public</span> <span style="color: blue;">void</span> RecordMp3(<span style="color: blue;">string</span> fileName)</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; recEx.Close += <span style="color: blue;">new</span> <span style="color: teal;">EventHandler</span>(recEx_CloseMp3);</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; recEx.Data += <span style="color: blue;">new</span> <span style="color: teal;">RecorderEx</span>.<span style="color: teal;">DataEventHandler</span>(recEx_DataMp3);</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: teal;">FormatDetails</span>[] fdArr = <span style="color: teal;">AudioCompressionManager</span>.GetFormatList(<span style="color: teal;">AudioCompressionManager</span>.MpegLayer3FormatTag);</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: teal;">IntPtr</span> format = fdArr[fdArr.Length - 1].FormatHandle;<span style="color: green;">//GetMp3Format(2, 56, 24000);</span></p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; recEx.Format = format;</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; mw = <span style="color: blue;">new</span> <span style="color: teal;">Mp3Writer</span>(<span style="color: teal;">File</span>.Create(fileName));</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; recEx.StartRecord();</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }</p> 
</div> 
</div> 
</a><br><a href="#questions" class="standardsButton"><font color="#ffffff"> 
		Up
		</font></a></td></tr><tr><td><a name="tip45"><h2>45. Can Alvas.NET perform mp3 playing in C# with selected sound card. I have multiple sound card on my PC.</h2> 
<div class=code> 
<div style="font-family: Courier New; font-size: 10pt; color: black; background: white;"> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">private</span> <span style="color: blue;">void</span> PlayMp3()</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; playEx.PlayerID = 0;<span style="color: green;">//select your sound card </span></p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">string</span> fileName = <span style="color: maroon;">@"c:\test.mp3"</span>;</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: teal;">Mp3Reader</span> br = <span style="color: blue;">new</span> <span style="color: teal;">Mp3Reader</span>(<span style="color: teal;">File</span>.OpenRead(fileName));</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: teal;">IntPtr</span> format = br.ReadFormat();</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">byte</span>[] data = br.ReadData();</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; br.Close();</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; playEx.OpenPlayer(format);</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; playEx.AddData(data);</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; playEx.StartPlay();</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }</p> 
</div> 
</div> 
</a><br><a href="#questions" class="standardsButton"><font color="#ffffff"> 
		Up
		</font></a></td></tr><tr><td><a name="tip46"><h2>46. I would like to know if it is possible to record both line-in and line-out from a soundcard 
(full duplex).</h2> 
<div class=code> 
<div style="font-family: Courier New; font-size: 10pt; color: black; background: white;"> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; <span style="color: blue;">public</span> <span style="color: blue;">class</span> RecordPlayForm : Form</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; {</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">public</span> RecordPlayForm()</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; InitializeComponent();</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; Init();</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }</p> 
<p style="margin: 0px;">&nbsp;</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; RecorderEx rex = <span style="color: blue;">new</span> RecorderEx();</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; PlayerEx play = <span style="color: blue;">new</span> PlayerEx();</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: teal;">IntPtr</span> pcmFormat = AudioCompressionManager.GetPcmFormat(1, 16, 44100);</p> 
<p style="margin: 0px;">&nbsp;</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">private</span> <span style="color: blue;">void</span> Init()</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; rex.Data += <span style="color: blue;">new</span> RecorderEx.DataEventHandler(rex_Data);</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; rex.Open += <span style="color: blue;">new</span> <span style="color: teal;">EventHandler</span>(rex_Open);</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; rex.Close += <span style="color: blue;">new</span> <span style="color: teal;">EventHandler</span>(rex_Close);</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; rex.Format = pcmFormat;</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }</p> 
<p style="margin: 0px;">&nbsp;</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">void</span> rex_Open(<span style="color: blue;">object</span> sender, <span style="color: teal;">EventArgs</span> e)</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; play.OpenPlayer(pcmFormat);</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; play.StartPlay();</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }</p> 
<p style="margin: 0px;">&nbsp;</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">void</span> rex_Close(<span style="color: blue;">object</span> sender, <span style="color: teal;">EventArgs</span> e)</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; play.ClosePlayer();</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }</p> 
<p style="margin: 0px;">&nbsp;</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">void</span> rex_Data(<span style="color: blue;">object</span> sender, DataEventArgs e)</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; play.AddData(e.Data);</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }</p> 
<p style="margin: 0px;">&nbsp;</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">private</span> <span style="color: blue;">void</span> btnRecordPlay_Click(<span style="color: blue;">object</span> sender, <span style="color: teal;">EventArgs</span> e)</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; rex.StartRecord();</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }</p> 
<p style="margin: 0px;">&nbsp;</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">private</span> <span style="color: blue;">void</span> btnStop_Click(<span style="color: blue;">object</span> sender, <span style="color: teal;">EventArgs</span> e)</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; rex.StopRecord();</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; }</p> 
</div> 
</div> 
</a><br><a href="#questions" class="standardsButton"><font color="#ffffff"> 
		Up
		</font></a></td></tr><tr><td><a name="tip47"><h2>47. Does Alvas.Audio support 64bit operating systems?</h2> 
Yes. You need change your project property "Project/<Project> Properties.../Build/Platform Target" to "x86" and rebuild.
</br> 
</a><br><a href="#questions" class="standardsButton"><font color="#ffffff"> 
		Up
		</font></a></td></tr><tr><td><a name="tip48"><h2>48. How can I check frequency (sample rate) of MP3 file?
The only way I could find is to use FormatDetails struct and parse frequency out of it's FormatName property. However, I'm sure there are nicer way to achieve this :)</h2> 
Please use WaveFormat.nSamplesPerSec field.
</br> 
</a><br><a href="#questions" class="standardsButton"><font color="#ffffff"> 
		Up
		</font></a></td></tr><tr><td><a name="tip49"><h2>49. I am a newbie trying to recode MP3 file to a different bit rate/sample 
rate/mode. Like changing the Bit rate, Sample rate or changing from stereo 
to mono or their combination.
 
I would really appreciate any help, with code if possible.</h2> 
To change you need to decode mp3 to pcm. Edit pcm and encoding back to mp3. 
The example shows how to change the frequency to 8000.
</br> 
<div class=code> 
<div style="font-family: Courier New; font-size: 10pt; color: black; background: white;"> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">public</span> <span style="color: blue;">void</span> Mp3(<span style="color: blue;">string</span> inFile)</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: green;">//mp3 -&gt; mp3 mono 8000 samples per second example</span></p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">int</span> sps = 8000;</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">short</span> mono = 1;</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">string</span> outFile = inFile + <span style="color: maroon;">".mp3"</span>;</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: teal;">Mp3Reader</span> mr = <span style="color: blue;">new</span> <span style="color: teal;">Mp3Reader</span>(<span style="color: teal;">File</span>.OpenRead(inFile));</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: teal;">IntPtr</span> formatMp3 = mr.ReadFormat();</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">byte</span>[] dataMp3 = mr.ReadData();</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; mr.Close();</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: teal;">IntPtr</span> formatPcm = <span style="color: teal;">AudioCompressionManager</span>.GetCompatibleFormat(formatMp3, <span style="color: teal;">AudioCompressionManager</span>.PcmFormatTag);</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: green;">//mp3 -&gt; pcm</span></p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">byte</span>[] dataPcm = <span style="color: teal;">AudioCompressionManager</span>.Convert(formatMp3, formatPcm, dataMp3, <span style="color: blue;">false</span>);</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: teal;">WaveFormat</span> wf = <span style="color: teal;">AudioCompressionManager</span>.GetWaveFormat(formatPcm);</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: teal;">IntPtr</span> formatPcm8000 = <span style="color: teal;">AudioCompressionManager</span>.GetPcmFormat(mono, wf.wBitsPerSample, sps);</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: green;">//pcm -&gt; pcm 8000 sps</span></p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">byte</span>[] dataPcm8000 = <span style="color: teal;">AudioCompressionManager</span>.Convert(formatPcm, formatPcm8000, dataPcm, <span style="color: blue;">false</span>);</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: green;">//pcm8000 -&gt; mp3 8000 sps</span></p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: teal;">IntPtr</span> formatMp3_8000 = <span style="color: teal;">AudioCompressionManager</span>.GetCompatibleFormat(formatPcm8000, <span style="color: teal;">AudioCompressionManager</span>.MpegLayer3FormatTag);</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">byte</span>[] dataMp3_8000 = <span style="color: teal;">AudioCompressionManager</span>.Convert(formatPcm8000, formatMp3_8000, dataPcm8000, <span style="color: blue;">false</span>);</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: teal;">Mp3Writer</span> mw = <span style="color: blue;">new</span> <span style="color: teal;">Mp3Writer</span>(<span style="color: teal;">File</span>.Create(outFile));</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; mw.WriteData(dataMp3_8000);</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; mw.Close();</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }</p> 
</div> 
</div> 
</a><br><a href="#questions" class="standardsButton"><font color="#ffffff"> 
		Up
		</font></a></td></tr><tr><td><a name="tip50"><h2>50. Can you give an example to convert a mp3 file from 320kbps bit rate, stereo, 
44khz sample rate to 48kbps bit rate, mono, 22khz.</h2> 
<div class=code> 
<div style="font-family: Courier New; font-size: 10pt; color: black; background: white;"> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">public</span> <span style="color: blue;">void</span> Mp3(<span style="color: blue;">string</span> inFile)</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: green;">//mp3 -&gt; mp3 mono 48000 samples per second example</span></p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">int</span> sps = 48000;</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">short</span> mono = 1;</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">string</span> outFile = inFile + <span style="color: maroon;">".mp3"</span>;</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: teal;">Mp3Reader</span> mr = <span style="color: blue;">new</span> <span style="color: teal;">Mp3Reader</span>(<span style="color: teal;">File</span>.OpenRead(inFile));</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: teal;">IntPtr</span> formatMp3 = mr.ReadFormat();</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">byte</span>[] dataMp3 = mr.ReadData();</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; mr.Close();</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: teal;">IntPtr</span> formatPcm = <span style="color: teal;">AudioCompressionManager</span>.GetCompatibleFormat(formatMp3, <span style="color: teal;">AudioCompressionManager</span>.PcmFormatTag);</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: green;">//mp3 -&gt; pcm</span></p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">byte</span>[] dataPcm = <span style="color: teal;">AudioCompressionManager</span>.Convert(formatMp3, formatPcm, dataMp3, <span style="color: blue;">false</span>);</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: teal;">WaveFormat</span> wf = <span style="color: teal;">AudioCompressionManager</span>.GetWaveFormat(formatPcm);</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: teal;">IntPtr</span> formatPcm8000 = <span style="color: teal;">AudioCompressionManager</span>.GetPcmFormat(mono, wf.wBitsPerSample, sps);</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: green;">//pcm -&gt; pcm 48000 sps</span></p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">byte</span>[] dataPcm8000 = <span style="color: teal;">AudioCompressionManager</span>.Convert(formatPcm, formatPcm8000, dataPcm, <span style="color: blue;">false</span>);</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: green;">//pcm8000 -&gt; mp3 48000 sps</span></p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: teal;">IntPtr</span> formatMp3_8000 = <span style="color: teal;">AudioCompressionManager</span>.GetCompatibleFormat(formatPcm8000, <span style="color: teal;">AudioCompressionManager</span>.MpegLayer3FormatTag);</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">byte</span>[] dataMp3_8000 = <span style="color: teal;">AudioCompressionManager</span>.Convert(formatPcm8000, formatMp3_8000, dataPcm8000, <span style="color: blue;">false</span>);</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: teal;">Mp3Writer</span> mw = <span style="color: blue;">new</span> <span style="color: teal;">Mp3Writer</span>(<span style="color: teal;">File</span>.Create(outFile));</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; mw.WriteData(dataMp3_8000);</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; mw.Close();</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }</p> 
</div> 
</div> 
</a><br><a href="#questions" class="standardsButton"><font color="#ffffff"> 
		Up
		</font></a></td></tr><tr><td><a name="tip51"><h2>51. Our company needs audio control, which can record separately and 
independently right and left channel from stereo input. Has Alvas.Audio got 
such functionality?</h2> 
Yes, You can use AudioCompressionManager.SplitStereo method for split one stereo to 2 mono.
</br> 
<div class=code> 
<div style="font-family: Courier New; font-size: 10pt; color: black; background: white;"> 
<p style="margin: 0px;"><span style="color: blue;">using</span> System;</p> 
<p style="margin: 0px;"><span style="color: blue;">using</span> Alvas.Audio;</p> 
<p style="margin: 0px;"><span style="color: blue;">using</span> System.IO;</p> 
<p style="margin: 0px;"><span style="color: blue;">using</span> System.Windows.Forms;</p> 
<p style="margin: 0px;">&nbsp;</p> 
<p style="margin: 0px;"><span style="color: blue;">namespace</span> ConvertMp3</p> 
<p style="margin: 0px;">{</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; <span style="color: blue;">public</span> <span style="color: blue;">partial</span> <span style="color: blue;">class</span> <span style="color: teal;">Form1</span> : <span style="color: teal;">Form</span></p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; {</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">public</span> Form1()</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; InitializeComponent();</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; Init();</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }</p> 
<p style="margin: 0px;">&nbsp;</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">private</span> <span style="color: blue;">void</span> Init()</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; rex.Open += <span style="color: blue;">new</span> <span style="color: teal;">EventHandler</span>(rex_Open);</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; rex.Data += <span style="color: blue;">new</span> <span style="color: teal;">RecorderEx</span>.<span style="color: teal;">DataEventHandler</span>(rex_Data);</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; rex.Close += <span style="color: blue;">new</span> <span style="color: teal;">EventHandler</span>(rex_Close);</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }</p> 
<p style="margin: 0px;">&nbsp;</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">void</span> rex_Data(<span style="color: blue;">object</span> sender, <span style="color: teal;">DataEventArgs</span> e)</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: teal;">IntPtr</span> formatMono = <span style="color: teal;">IntPtr</span>.Zero;</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: teal;">AudioCompressionManager</span>.SplitStereo(rex.Format, e.Data, <span style="color: blue;">ref</span> </p> 
<p style="margin: 0px;">formatMono,</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">ref</span> leftData, <span style="color: blue;">ref</span> rightData);</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">if</span> (ww1 == <span style="color: blue;">null</span>)</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">byte</span>[] formatBytes =</p> 
<p style="margin: 0px;"><span style="color: teal;">AudioCompressionManager</span>.FormatBytes(formatMono);</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; ww1 = <span style="color: blue;">new</span> <span style="color: teal;">WaveWriter</span>(<span style="color: teal;">File</span>.Create(<span style="color: maroon;">"left.wav"</span>), formatBytes);</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; ww2 = <span style="color: blue;">new</span> <span style="color: teal;">WaveWriter</span>(<span style="color: teal;">File</span>.Create(<span style="color: maroon;">"right.wav"</span>), formatBytes);</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; ww1.WriteData(leftData);</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; ww2.WriteData(rightData);</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }</p> 
<p style="margin: 0px;">&nbsp;</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">void</span> rex_Open(<span style="color: blue;">object</span> sender, <span style="color: teal;">EventArgs</span> e)</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }</p> 
<p style="margin: 0px;">&nbsp;</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">void</span> rex_Close(<span style="color: blue;">object</span> sender, <span style="color: teal;">EventArgs</span> e)</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; ww1.Close();</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; ww2.Close();</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; ww1 = <span style="color: blue;">null</span>;</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; ww2 = <span style="color: blue;">null</span>;</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }</p> 
<p style="margin: 0px;">&nbsp;</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: teal;">RecorderEx</span> rex = <span style="color: blue;">new</span> <span style="color: teal;">RecorderEx</span>();</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: teal;">WaveWriter</span> ww1;</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: teal;">WaveWriter</span> ww2;</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">byte</span>[] leftData = <span style="color: blue;">null</span>;</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">byte</span>[] rightData = <span style="color: blue;">null</span>;</p> 
<p style="margin: 0px;">&nbsp;</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">private</span> <span style="color: blue;">void</span> btnRecord_Click(<span style="color: blue;">object</span> sender, <span style="color: teal;">EventArgs</span> e)</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; rex.Format = <span style="color: teal;">AudioCompressionManager</span>.GetPcmFormat(2, 16, 44100);</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; rex.StartRecord();</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }</p> 
<p style="margin: 0px;">&nbsp;</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">private</span> <span style="color: blue;">void</span> btnStop_Click(<span style="color: blue;">object</span> sender, <span style="color: teal;">EventArgs</span> e)</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; rex.StopRecord();</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; }</p> 
<p style="margin: 0px;">}</p> 
</div> 
</div> 
</a><br><a href="#questions" class="standardsButton"><font color="#ffffff"> 
		Up
		</font></a></td></tr><tr><td><a name="tip52"><h2>52. How can I get higher quality when converting from .vox to .mp3.</h2> 
<div class=code> 
<div style="font-family: Courier New; font-size: 10pt; color: black; background: white;"> 
<p style="margin: 0px;">Vox2Mp3(<span style="color: maroon;">@"c:\audio\files\8000.vox"</span>, 8000, 16000);</p> 
<p style="margin: 0px;">&nbsp;</p> 
<p style="margin: 0px;">&nbsp;</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">private</span> <span style="color: blue;">static</span> <span style="color: blue;">void</span> Vox2Mp3(<span style="color: blue;">string</span> voxFile, <span style="color: blue;">int</span> samplesPerSecFrom, </p> 
<p style="margin: 0px;"><span style="color: blue;">int</span> samplesPerSecTo)</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: teal;">BinaryReader</span> br = <span style="color: blue;">new</span> <span style="color: teal;">BinaryReader</span>(<span style="color: teal;">File</span>.OpenRead(voxFile));</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: teal;">MemoryStream</span> pcmStream = <span style="color: blue;">new</span> <span style="color: teal;">MemoryStream</span>();</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: teal;">IntPtr</span> pcmFormat = <span style="color: teal;">AudioCompressionManager</span>.GetPcmFormat(1, 16, </p> 
<p style="margin: 0px;">samplesPerSecFrom);</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: teal;">WaveWriter</span> ww = <span style="color: blue;">new</span> <span style="color: teal;">WaveWriter</span>(pcmStream, </p> 
<p style="margin: 0px;"><span style="color: teal;">AudioCompressionManager</span>.FormatBytes(pcmFormat));</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: teal;">Vox</span>.Vox2Wav(br, ww);</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; br.Close();</p> 
<p style="margin: 0px;">&nbsp;</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: teal;">WaveReader</span> wr = <span style="color: blue;">new</span> <span style="color: teal;">WaveReader</span>(pcmStream);</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">byte</span>[] pcmData = wr.ReadData();</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; wr.Close();</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: teal;">IntPtr</span> pcmFormat2 = <span style="color: teal;">AudioCompressionManager</span>.GetPcmFormat(1, 16, </p> 
<p style="margin: 0px;">samplesPerSecTo);</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">byte</span>[] pcmData2 = <span style="color: teal;">AudioCompressionManager</span>.Convert(pcmFormat, </p> 
<p style="margin: 0px;">pcmFormat2, pcmData, <span style="color: blue;">false</span>);</p> 
<p style="margin: 0px;">&nbsp;</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: teal;">IntPtr</span> mp3Format = </p> 
<p style="margin: 0px;"><span style="color: teal;">AudioCompressionManager</span>.GetCompatibleFormat(pcmFormat2, </p> 
<p style="margin: 0px;"><span style="color: teal;">AudioCompressionManager</span>.MpegLayer3FormatTag);</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">byte</span>[] data = <span style="color: teal;">AudioCompressionManager</span>.Convert(pcmFormat2, </p> 
<p style="margin: 0px;">mp3Format, pcmData2, <span style="color: blue;">false</span>);</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">string</span> mp3File = voxFile + <span style="color: maroon;">".mp3"</span>;</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: teal;">Mp3Writer</span> mw = <span style="color: blue;">new</span> <span style="color: teal;">Mp3Writer</span>(<span style="color: teal;">File</span>.Create(mp3File));</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; mw.WriteData(data);</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; ww.Close();</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; mw.Close();</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }</p> 
</div> 
</div> 
</a><br><a href="#questions" class="standardsButton"><font color="#ffffff"> 
		Up
		</font></a></td></tr><tr><td><a name="tip53"><h2>53. Could you be more specific about adding the control to the toolbox.</h2> 
Right-click on Toolbox, click "Add Tab" and enter "Alvas.Audio", click "Choose Items...", click "Browse..." and select Alvas.Audio.dll. Click "OK".
</br> 
</a><br><a href="#questions" class="standardsButton"><font color="#ffffff"> 
		Up
		</font></a></td></tr><tr><td><a name="tip54"><h2>54. After the file has been played I want to delete it, but I get an “access denied” error, because the file is in use. Is there a way to release the file from the DSReader (or PlayerEx) so that I can delete it?</h2> 
DSReader.Close();
</br> 
</a><br><a href="#questions" class="standardsButton"><font color="#ffffff"> 
		Up
		</font></a></td></tr><tr><td><a name="tip55"><h2>55. I'm looking for .net a component like yours that can convert .wma to .mp3 - can it easily to that.</h2> 
<div class=code> 
<div style="font-family: Courier New; font-size: 10pt; color: black; background: white;"> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">private</span> <span style="color: blue;">void</span> WmaToMp3(<span style="color: blue;">string</span> fileName)</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; DsReader dr = <span style="color: blue;">new</span> DsReader(fileName);</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: teal;">IntPtr</span> format = dr.ReadFormat();</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: teal;">IntPtr</span> formatMp3 =</p> 
<p style="margin: 0px;">AudioCompressionManager.GetCompatibleFormat(format,</p> 
<p style="margin: 0px;">AudioCompressionManager.MpegLayer3FormatTag);</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">byte</span>[] data = dr.ReadData();</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; dr.Close();</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">byte</span>[] dataMp3 = AudioCompressionManager.Convert(format,</p> 
<p style="margin: 0px;">formatMp3, data, <span style="color: blue;">false</span>);</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; Mp3Writer mw = <span style="color: blue;">new</span> Mp3Writer(File.Create(fileName + <span style="color: maroon;">".mp3"</span>));</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; mw.WriteData(dataMp3);</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; mw.Close();</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }</p> 
</div> 
</div> 
</a><br><a href="#questions" class="standardsButton"><font color="#ffffff"> 
		Up
		</font></a></td></tr><tr><td><a name="tip56"><h2>56. Does Alvas.Audio work with Windows 7 RTM?</h2> 
Yes
</br> 
</a><br><a href="#questions" class="standardsButton"><font color="#ffffff"> 
		Up
		</font></a></td></tr><tr><td><a name="tip57"><h2>57. Is it possible to increase/amplify the volume of mp3 file using Alvas.Audio library?</h2> 
<div class=code> 
<div style="font-family: Courier New; font-size: 10pt; color: black; background: white;"> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">public</span> <span style="color: blue;">static</span> <span style="color: blue;">void</span> ChangeVolumeMp3(<span style="color: blue;">string</span> inFile, <span style="color: blue;">string</span> outFile)</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; Mp3Reader mr = <span style="color: blue;">new</span> Mp3Reader(File.OpenRead(inFile));</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">byte</span>[] data =</p> 
<p style="margin: 0px;">AudioCompressionManager.ChangeVolume(mr.ReadFormat(), mr.ReadData(), 50);</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; mr.Close();</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; Mp3Writer mw = <span style="color: blue;">new</span> Mp3Writer(File.Create(outFile));</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; mw.WriteData(data);</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; mw.Close();</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }</p> 
</div> 
</div> 
</a><br><a href="#questions" class="standardsButton"><font color="#ffffff"> 
		Up
		</font></a></td></tr><tr><td><a name="tip58"><h2>58. Is it possible to work directly on free licence file formats like Ogg Vorbis?</h2> 
Yes. You need only install "Ogg Vorbis for MSACM" codec 
<a target=_blank href=http://www.free-codecs.com/Ogg_Vorbis_CODEC_for_MSACM_download.htm>http://www.free-codecs.com/Ogg_Vorbis_CODEC_for_MSACM_download.htm</a> 
</br> 
</a><br><a href="#questions" class="standardsButton"><font color="#ffffff"> 
		Up
		</font></a></td></tr><tr><td><a name="tip59"><h2>59. Can I convert an MP3 file to .VOX format?</h2> 
<div class=code> 
<div style="font-family: Courier New; font-size: 10pt; color: black; background: white;"> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">public</span> <span style="color: blue;">static</span> <span style="color: blue;">void</span> Mp3ToVox(<span style="color: blue;">string</span> mp3File, <span style="color: blue;">string</span> voxFile)</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">int</span> samplesPerSec = 8000;</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; Mp3Reader mr = <span style="color: blue;">new</span> Mp3Reader(File.OpenRead(mp3File));</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: teal;">IntPtr</span> format = mr.ReadFormat();</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">byte</span>[] data = mr.ReadData();</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; mr.Close();</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: teal;">IntPtr</span> formatPcm = AudioCompressionManager.GetCompatibleFormat(format, AudioCompressionManager.PcmFormatTag);</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; WaveFormat wfPcm = AudioCompressionManager.GetWaveFormat(formatPcm);</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">byte</span>[] dataPcm = AudioCompressionManager.Convert(format, formatPcm, data, <span style="color: blue;">false</span>);</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">if</span> (wfPcm.nSamplesPerSec != samplesPerSec)</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; Resample(<span style="color: blue;">ref</span> formatPcm, <span style="color: blue;">ref</span> dataPcm, <span style="color: blue;">ref</span> wfPcm, samplesPerSec);</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; BinaryWriter bw = <span style="color: blue;">new</span> BinaryWriter(File.OpenWrite(voxFile));</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; BinaryReader br = <span style="color: blue;">new</span> BinaryReader(<span style="color: blue;">new</span> MemoryStream(dataPcm));</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; Vox.Raw2Vox(br, bw, wfPcm.wBitsPerSample);</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; br.Close();</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; bw.Close();</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }</p> 
<p style="margin: 0px;">&nbsp;</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">private</span> <span style="color: blue;">static</span> <span style="color: blue;">void</span> Resample(<span style="color: blue;">ref</span> <span style="color: teal;">IntPtr</span> format, <span style="color: blue;">ref</span> <span style="color: blue;">byte</span>[] data, <span style="color: blue;">ref</span> WaveFormat wf, <span style="color: blue;">int</span> samplesPerSec)</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: teal;">IntPtr</span> newFormat = AudioCompressionManager.GetPcmFormat(wf.nChannels, wf.wBitsPerSample, samplesPerSec);</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">byte</span>[] buffer = AudioCompressionManager.Convert(format, newFormat, data, <span style="color: blue;">false</span>);</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; format = newFormat;</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; wf = AudioCompressionManager.GetWaveFormat(newFormat);</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; data = buffer;</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }</p> 
</div> 
</div> 
</a><br><a href="#questions" class="standardsButton"><font color="#ffffff"> 
		Up
		</font></a></td></tr><tr><td><a name="tip60"><h2>60. I have a byte array of PCM audio.  I would like to convert that to a byte array of GSM audio (and back).  Would your Alvas.Audio library be able to do that?</h2> 
<div class=code> 
<div style="font-family: Courier New; font-size: 10pt; color: black; background: white;"> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">private</span> <span style="color: blue;">static</span> <span style="color: blue;">void</span> TestGsmPcm()</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: teal;">IntPtr</span> formatPcm = AudioCompressionManager.GetPcmFormat(1, 16,</p> 
<p style="margin: 0px;">8000);</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">byte</span>[] dataPcm = <span style="color: blue;">null</span>;<span style="color: green;">//your pcm data</span></p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: teal;">IntPtr</span> formatGsm;</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">byte</span>[] dataGsm;</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: green;">//pcm -&gt; gsm</span></p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; Convert(formatPcm, dataPcm,</p> 
<p style="margin: 0px;">AudioCompressionManager.Gsm610FormatTag, <span style="color: blue;">out</span> formatGsm, <span style="color: blue;">out</span> dataGsm);</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: green;">//gsm -&gt; pcm</span></p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; Convert(formatGsm, dataGsm,</p> 
<p style="margin: 0px;">AudioCompressionManager.PcmFormatTag, <span style="color: blue;">out</span> formatPcm, <span style="color: blue;">out</span> dataPcm);</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }</p> 
<p style="margin: 0px;">&nbsp;</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">private</span> <span style="color: blue;">static</span> <span style="color: blue;">void</span> Convert(<span style="color: teal;">IntPtr</span> formatIn, <span style="color: blue;">byte</span>[] dataIn, <span style="color: blue;">short</span></p> 
<p style="margin: 0px;">formatTag, <span style="color: blue;">out</span> <span style="color: teal;">IntPtr</span> formatOut, <span style="color: blue;">out</span> <span style="color: blue;">byte</span>[] dataOut)</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; formatOut =</p> 
<p style="margin: 0px;">AudioCompressionManager.GetCompatibleFormat(formatIn, formatTag);</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; dataOut = AudioCompressionManager.Convert(formatIn, formatOut,</p> 
<p style="margin: 0px;">dataIn, <span style="color: blue;">false</span>);</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }</p> 
</div> 
</div> 
</a><br><a href="#questions" class="standardsButton"><font color="#ffffff"> 
		Up
		</font></a></td></tr><tr><td><a name="tip61"><h2>61. Is there a way to use a specific codec? For example, say I install the lame.acm as part of my application installation. Then the user decides to installs other codecs for some reason. Can I specifically ensure that I use my specific codec?</h2> 
<div class=code> 
<style type="text/css"> 
.cf { font-family: Courier New; font-size: 10pt; color: black; background: white; }
.cl { margin: 0px; }
.cb1 { color: blue; }
.cb2 { color: teal; }
.cb3 { color: maroon; }
</style> 
<div class="cf"> 
<p class="cl">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span class="cb1">private</span> <span class="cb1">void</span> GetDriver()</p> 
<p class="cl">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {</p> 
<p class="cl">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span class="cb1">foreach</span> (<span class="cb2">DriverDetails</span> dd <span class="cb1">in</span> <span class="cb2">AudioCompressionManager</span>.GetDriverList())</p> 
<p class="cl">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {</p> 
<p class="cl">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span class="cb1">if</span> (dd.LongName.Contains(<span class="cb3">"{insert text here}"</span>))</p> 
<p class="cl">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {</p> 
<p class="cl">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span class="cb1">int</span> driverId = dd.Driver;</p> 
<p class="cl">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span class="cb2">FormatDetails</span>[] fd = <span class="cb2">AudioCompressionManager</span>.GetFormatList(<span class="cb2">AudioCompressionManager</span>.MpegLayer3FormatTag, driverId, <span class="cb1">true</span>);</p> 
<p class="cl">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span class="cb1">break</span>;</p> 
<p class="cl">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }</p> 
<p class="cl">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; };</p> 
<p class="cl">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }</p> 
</div> 
</div> 
</a><br><a href="#questions" class="standardsButton"><font color="#ffffff"> 
		Up
		</font></a></td></tr><tr><td><a name="tip62"><h2>62. We're having some troubles with big audio files when we attempt to convert them from mp3 to wav: System.OutOfMemoryException: Exception of type 'System.OutOfMemoryException' was thrown.</h2> 
<div class=code> 
<div style="font-family: Courier New; font-size: 10pt; color: black; background: white;"> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">public</span> <span style="color: blue;">static</span> <span style="color: blue;">bool</span> Mp3ToWav(<span style="color: blue;">string</span> inFile, <span style="color: blue;">string</span> outFile)</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">using</span> (<span style="color: teal;">Mp3Reader</span> mp3 = <span style="color: blue;">new</span> <span style="color: teal;">Mp3Reader</span>(<span style="color: teal;">File</span>.OpenRead(inFile)))</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">try</span></p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: teal;">IntPtr</span> mp3Format = mp3.ReadFormat();</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: teal;">IntPtr</span> pcmFormat = <span style="color: teal;">AudioCompressionManager</span>.GetCompatibleFormat(mp3Format, <span style="color: teal;">AudioCompressionManager</span>.PcmFormatTag);</p> 
<p style="margin: 0px;">&nbsp;</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: teal;">AcmConverter</span> acm = <span style="color: blue;">new</span> <span style="color: teal;">AcmConverter</span>(mp3Format, pcmFormat, <span style="color: blue;">false</span>);</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">int</span> sec = 1000;</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">int</span> i = 0;</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">using</span> (<span style="color: teal;">WaveWriter</span> ww = <span style="color: blue;">new</span> <span style="color: teal;">WaveWriter</span>(<span style="color: teal;">File</span>.OpenWrite(outFile), <span style="color: teal;">AudioCompressionManager</span>.FormatBytes(pcmFormat)))</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">while</span> (<span style="color: blue;">true</span>)</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">byte</span>[] mp3Data = mp3.ReadData(i, 1000);</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">if</span> (mp3Data.Length == 0)</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">break</span>;</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">byte</span>[] pcmData = acm.Convert(mp3Data);</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; ww.WriteData(pcmData);</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; i += sec;</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; ww.Close();</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; mp3.Close();</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: teal;">GC</span>.Collect();</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">return</span> <span style="color: blue;">true</span>;</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">catch</span> (<span style="color: teal;">Exception</span> ex)</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; mp3.Close();</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: teal;">Console</span>.WriteLine(<span style="color: maroon;">"\tCan not convert Mp3 to Wav, "</span> + ex.ToString());</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">return</span> <span style="color: blue;">false</span>;</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }</p> 
</div> 
</div> 
</a><br><a href="#questions" class="standardsButton"><font color="#ffffff"> 
		Up
		</font></a></td></tr><tr><td><a name="tip63"><h2>63. Can Alvas.Audio can detect silence detection?</h2> 
Yes. Please see RecordPlay demo "skip silent"
</a><br><a href="#questions" class="standardsButton"><font color="#ffffff"> 
		Up
		</font></a></td></tr><tr><td><a name="tip64"><h2>64. I would like to be able to select the input device like Microphone or CD Audio when recording sound.</h2> 
Please see RecordPlay example
</a><br><a href="#questions" class="standardsButton"><font color="#ffffff"> 
		Up
		</font></a></td></tr><tr><td><a name="tip65"><h2>65. Does your audio control allow real time monitoring of the lenght of the
recording? Basically while its recording, can I see position with the scroll bar?</h2> 
Yes. Please see RecordPlay demo
</a><br><a href="#questions" class="standardsButton"><font color="#ffffff"> 
		Up
		</font></a></td></tr><tr><td><a name="tip66"><h2>66. Can your audio library playback Shoutcast or Icecast radio streams? I also need to extract metadata from stream.</h2> 
<div class=code> 
<div style="font-family: Courier New; font-size: 10pt; color: black; background: white;"> 
<p style="margin: 0px;"><span style="color: blue;">Imports</span> Alvas.Audio</p> 
<p style="margin: 0px;">&nbsp;</p> 
<p style="margin: 0px;"><span style="color: blue;">Public</span> <span style="color: blue;">Class</span> MainForm</p> 
<p style="margin: 0px;">&nbsp;</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; <span style="color: blue;">Private</span> <span style="color: blue;">Sub</span> btnPlay_Click(<span style="color: blue;">ByVal</span> sender <span style="color: blue;">As</span> System.Object, <span style="color: blue;">ByVal</span> e <span style="color: blue;">As</span> System.EventArgs) <span style="color: blue;">Handles</span> btnPlay.Click</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; ReadRadio(<span style="color: maroon;">"http://www.wmph.org:7050/wmph64k"</span>)</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; <span style="color: blue;">End</span> <span style="color: blue;">Sub</span></p> 
<p style="margin: 0px;">&nbsp;</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; <span style="color: blue;">Private</span> <span style="color: blue;">Sub</span> btnStop_Click(<span style="color: blue;">ByVal</span> sender <span style="color: blue;">As</span> System.Object, <span style="color: blue;">ByVal</span> e <span style="color: blue;">As</span> System.EventArgs) <span style="color: blue;">Handles</span> btnStop.Click</p> 
<p style="margin: 0px;">&nbsp;</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">If</span> <span style="color: blue;">Not</span> t <span style="color: blue;">Is</span> <span style="color: blue;">Nothing</span> <span style="color: blue;">AndAlso</span> t.ThreadState = Threading.ThreadState.Running <span style="color: blue;">Then</span></p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; t.Abort()</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; btnStop.Enabled = <span style="color: blue;">False</span></p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; btnPlay.Enabled = <span style="color: blue;">True</span></p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">End</span> <span style="color: blue;">If</span></p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; <span style="color: blue;">End</span> <span style="color: blue;">Sub</span></p> 
<p style="margin: 0px;">&nbsp;</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; <span style="color: blue;">Private</span> plex <span style="color: blue;">As</span> PlayerEx = <span style="color: blue;">New</span> Alvas.Audio.PlayerEx(<span style="color: blue;">True</span>)</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; <span style="color: blue;">Private</span> t <span style="color: blue;">As</span> Threading.Thread</p> 
<p style="margin: 0px;">&nbsp;</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; <span style="color: blue;">Private</span> <span style="color: blue;">Sub</span> ReadRadio(<span style="color: blue;">ByVal</span> StreamURL <span style="color: blue;">As</span> <span style="color: blue;">String</span>)</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; btnStop.Enabled = <span style="color: blue;">True</span></p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; btnPlay.Enabled = <span style="color: blue;">False</span></p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; t = <span style="color: blue;">New</span> System.Threading.Thread(<span style="color: blue;">New</span> System.Threading.ParameterizedThreadStart(<span style="color: blue;">AddressOf</span> ThreadProc))</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; t.Start(StreamURL)</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; <span style="color: blue;">End</span> <span style="color: blue;">Sub</span></p> 
<p style="margin: 0px;">&nbsp;</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; <span style="color: blue;">Private</span> <span style="color: blue;">Sub</span> ThreadProc(<span style="color: blue;">ByVal</span> StreamURL <span style="color: blue;">As</span> <span style="color: blue;">Object</span>)</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">Dim</span> WebReq <span style="color: blue;">As</span> System.Net.HttpWebRequest = <span style="color: blue;">CType</span>(System.Net.WebRequest.Create(StreamURL), System.Net.HttpWebRequest)</p> 
<p style="margin: 0px;">&nbsp;</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">Dim</span> MyURI <span style="color: blue;">As</span> <span style="color: blue;">New</span> Uri(StreamURL)</p> 
<p style="margin: 0px;">&nbsp;</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; WebReq.Headers.Clear()</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; WebReq.Timeout = 5000</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; WebReq.Headers.Add(<span style="color: maroon;">"GET"</span>, MyURI.AbsolutePath &amp; <span style="color: maroon;">" HTTP/1.0"</span>)</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; WebReq.UserAgent = <span style="color: maroon;">"WinampMPEG/5.0"</span></p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; WebReq.Headers.Add(<span style="color: maroon;">"Icy-MetaData"</span>, <span style="color: maroon;">"1"</span>)</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">Dim</span> WebRes <span style="color: blue;">As</span> System.Net.WebResponse = WebReq.GetResponse()</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">Dim</span> oReader <span style="color: blue;">As</span> System.IO.Stream = WebRes.GetResponseStream()</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">Dim</span> MetaInterval <span style="color: blue;">As</span> <span style="color: blue;">Integer</span> = WebRes.Headers(<span style="color: maroon;">"icy-metaint"</span>)</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">Dim</span> data(MetaInterval - 1) <span style="color: blue;">As</span> <span style="color: blue;">Byte</span></p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">Dim</span> b <span style="color: blue;">As</span> <span style="color: blue;">Byte</span> = 0</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">Dim</span> BlockCount <span style="color: blue;">As</span> <span style="color: blue;">Integer</span></p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">Try</span></p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">While</span> <span style="color: blue;">True</span></p> 
<p style="margin: 0px;">&nbsp;</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; b = oReader.ReadByte()</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">If</span> BlockCount = MetaInterval <span style="color: blue;">Then</span></p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">If</span> plex.State = DeviceState.Closed <span style="color: blue;">Then</span></p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">Dim</span> mr <span style="color: blue;">As</span> Mp3Reader = <span style="color: blue;">New</span> Mp3Reader(<span style="color: blue;">New</span> IO.MemoryStream(data))</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">Dim</span> format <span style="color: blue;">As</span> IntPtr = mr.ReadFormat()</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; mr.Close()</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; plex.OpenPlayer(format)</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; plex.StartPlay()</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">End</span> <span style="color: blue;">If</span></p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; plex.AddData(data)</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">Dim</span> MetaDataLength <span style="color: blue;">As</span> <span style="color: blue;">Integer</span> = b * 16</p> 
<p style="margin: 0px;">&nbsp;</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">If</span> MetaDataLength &gt; 0 <span style="color: blue;">Then</span></p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">Dim</span> MetaArray(MetaDataLength - 1) <span style="color: blue;">As</span> <span style="color: blue;">Byte</span></p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; oReader.Read(MetaArray, 0, MetaDataLength)</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">Dim</span> AEnc <span style="color: blue;">As</span> <span style="color: blue;">New</span> System.Text.ASCIIEncoding</p> 
<p style="margin: 0px;">&nbsp;</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">Dim</span> TempMetaData <span style="color: blue;">As</span> <span style="color: blue;">String</span> = AEnc.GetString(MetaArray)</p> 
<p style="margin: 0px;">&nbsp;</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: green;">'Trim it down</span></p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">Dim</span> StartPosition <span style="color: blue;">As</span> <span style="color: blue;">Integer</span> = TempMetaData.IndexOf(<span style="color: maroon;">"'"</span>) + 1</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">Dim</span> EndPosition <span style="color: blue;">As</span> <span style="color: blue;">Integer</span> = TempMetaData.IndexOf(<span style="color: maroon;">"';"</span>, StartPosition)</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; TempMetaData = TempMetaData.Substring(StartPosition, EndPosition - StartPosition)</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; Console.WriteLine(TempMetaData)</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">End</span> <span style="color: blue;">If</span></p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; BlockCount = 0</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">Continue</span> <span style="color: blue;">While</span></p> 
<p style="margin: 0px;">&nbsp;</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">Else</span></p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; data(BlockCount) = b</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">End</span> <span style="color: blue;">If</span></p> 
<p style="margin: 0px;">&nbsp;</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; BlockCount = BlockCount + 1</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">End</span> <span style="color: blue;">While</span></p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">Finally</span></p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; oReader.Close()</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; plex.ClosePlayer()</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">End</span> <span style="color: blue;">Try</span></p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; <span style="color: blue;">End</span> <span style="color: blue;">Sub</span></p> 
<p style="margin: 0px;">&nbsp;</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; <span style="color: blue;">Private</span> <span style="color: blue;">Sub</span> Form1_FormClosed(<span style="color: blue;">ByVal</span> sender <span style="color: blue;">As</span> System.Object, <span style="color: blue;">ByVal</span> e <span style="color: blue;">As</span> System.Windows.Forms.FormClosedEventArgs) <span style="color: blue;">Handles</span> <span style="color: blue;">MyBase</span>.FormClosed</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; btnStop.PerformClick()</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; <span style="color: blue;">End</span> <span style="color: blue;">Sub</span></p> 
<p style="margin: 0px;"><span style="color: blue;">End</span> <span style="color: blue;">Class</span></p> 
</div> 
</div> 
</a><br><a href="#questions" class="standardsButton"><font color="#ffffff"> 
		Up
		</font></a></td></tr><tr><td><a name="tip67"><h2>67. First, can you jump to a specific spot in a wav file and start recording from there?  
Meaning could I record for say five seconds, then replay the sound, 
then jump to the middle of the recording and start recording again from there?</h2> 
Yes. Please see RecordPlay example
</a><br><a href="#questions" class="standardsButton"><font color="#ffffff"> 
		Up
		</font></a></td></tr><tr><td><a name="tip68"><h2>68. I'm listening to an internet radio station over my speakers, and I'd like to record what I hear, and directly to an mp3 file. Can your alvas.audio contol record 'what you hear'? If so, how?</h2> 
<div class=code> 
<div style="font-family: Courier New; font-size: 10pt; color: black; background: white;"> 
<p style="margin: 0px;"><span style="color: blue;">using</span> System;</p> 
<p style="margin: 0px;"><span style="color: blue;">using</span> System.Windows.Forms;</p> 
<p style="margin: 0px;"><span style="color: blue;">using</span> Alvas.Audio;</p> 
<p style="margin: 0px;"><span style="color: blue;">using</span> System.IO;</p> 
<p style="margin: 0px;"><span style="color: blue;">using</span> System.Threading;</p> 
<p style="margin: 0px;">&nbsp;</p> 
<p style="margin: 0px;"><span style="color: blue;">namespace</span> RadioCs</p> 
<p style="margin: 0px;">{</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; <span style="color: blue;">public</span> <span style="color: blue;">partial</span> <span style="color: blue;">class</span> <span style="color: teal;">MainForm</span> : <span style="color: teal;">Form</span></p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; {</p> 
<p style="margin: 0px;">&nbsp;</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">public</span> MainForm()</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; InitializeComponent();</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; FormClosed += Form1_FormClosed;</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; btnPlay.Click += btnPlay_Click;</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; btnStop.Click += btnStop_Click;</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }</p> 
<p style="margin: 0px;">&nbsp;</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">private</span> <span style="color: blue;">void</span> btnPlay_Click(System.<span style="color: teal;">Object</span> sender, System.<span style="color: teal;">EventArgs</span> e)</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; ReadRadio(<span style="color: maroon;">"http://www.wmph.org:7050/wmph64k"</span>);</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }</p> 
<p style="margin: 0px;">&nbsp;</p> 
<p style="margin: 0px;">&nbsp;</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">private</span> <span style="color: blue;">void</span> btnStop_Click(System.<span style="color: teal;">Object</span> sender, System.<span style="color: teal;">EventArgs</span> e)</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">if</span> ((t != <span style="color: blue;">null</span>) &amp;&amp; t.ThreadState == <span style="color: teal;">ThreadState</span>.Running)</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; t.Abort();</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; btnStop.Enabled = <span style="color: blue;">false</span>;</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; btnPlay.Enabled = <span style="color: blue;">true</span>;</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }</p> 
<p style="margin: 0px;">&nbsp;</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">private</span> <span style="color: teal;">PlayerEx</span> plex = <span style="color: blue;">new</span> Alvas.Audio.<span style="color: teal;">PlayerEx</span>(<span style="color: blue;">true</span>);</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">private</span> System.Threading.<span style="color: teal;">Thread</span> t;</p> 
<p style="margin: 0px;">&nbsp;</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">private</span> <span style="color: blue;">void</span> ReadRadio(<span style="color: blue;">string</span> StreamURL)</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; btnStop.Enabled = <span style="color: blue;">true</span>;</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; btnPlay.Enabled = <span style="color: blue;">false</span>;</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; t = <span style="color: blue;">new</span> <span style="color: teal;">Thread</span>(<span style="color: blue;">new</span> <span style="color: teal;">ParameterizedThreadStart</span>(ThreadProc));</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; t.Start(StreamURL);</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }</p> 
<p style="margin: 0px;">&nbsp;</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">private</span> <span style="color: blue;">void</span> ThreadProc(<span style="color: blue;">object</span> StreamURL)</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; System.Net.<span style="color: teal;">HttpWebRequest</span> WebReq = (System.Net.<span style="color: teal;">HttpWebRequest</span>)System.Net.<span style="color: teal;">WebRequest</span>.Create(StreamURL.ToString());</p> 
<p style="margin: 0px;">&nbsp;</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: teal;">Uri</span> MyURI = <span style="color: blue;">new</span> <span style="color: teal;">Uri</span>(StreamURL.ToString());</p> 
<p style="margin: 0px;">&nbsp;</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; WebReq.Headers.Clear();</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; WebReq.Timeout = 5000;</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; WebReq.Headers.Add(<span style="color: maroon;">"GET"</span>, MyURI.AbsolutePath + <span style="color: maroon;">" HTTP/1.0"</span>);</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; WebReq.UserAgent = <span style="color: maroon;">"WinampMPEG/5.0"</span>;</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; WebReq.Headers.Add(<span style="color: maroon;">"Icy-MetaData"</span>, <span style="color: maroon;">"1"</span>);</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; System.Net.<span style="color: teal;">WebResponse</span> WebRes = WebReq.GetResponse();</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; System.IO.<span style="color: teal;">Stream</span> oReader = WebRes.GetResponseStream();</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">int</span> MetaInterval = <span style="color: teal;">Int32</span>.Parse(WebRes.Headers[<span style="color: maroon;">"icy-metaint"</span>]);</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">byte</span>[] data = <span style="color: blue;">new</span> <span style="color: blue;">byte</span>[MetaInterval];</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">byte</span> b = 0;</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: teal;">Mp3Writer</span> mw = <span style="color: blue;">new</span> <span style="color: teal;">Mp3Writer</span>(<span style="color: teal;">File</span>.Create(<span style="color: maroon;">"out.mp3"</span>));</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">int</span> BlockCount = 0;</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">try</span></p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">while</span> (<span style="color: blue;">true</span>)</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; b = (<span style="color: blue;">byte</span>)oReader.ReadByte();</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">if</span> (BlockCount == MetaInterval)</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: green;">//Metadata loop</span></p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; mw.WriteData(data);</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">if</span> (plex.State == <span style="color: teal;">DeviceState</span>.Closed)</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: teal;">Mp3Reader</span> mr = <span style="color: blue;">new</span> <span style="color: teal;">Mp3Reader</span>(<span style="color: blue;">new</span> <span style="color: teal;">MemoryStream</span>(data));</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: teal;">IntPtr</span> format = mr.ReadFormat();</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; mr.Close();</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; plex.OpenPlayer(format);</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; plex.StartPlay();</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; plex.AddData(data);</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">int</span> MetaDataLength = b * 16;</p> 
<p style="margin: 0px;">&nbsp;</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">if</span> (MetaDataLength &gt; 0)</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">byte</span>[] MetaArray = <span style="color: blue;">new</span> <span style="color: blue;">byte</span>[MetaDataLength];</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; oReader.Read(MetaArray, 0, MetaDataLength);</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; System.Text.<span style="color: teal;">ASCIIEncoding</span> AEnc = <span style="color: blue;">new</span> System.Text.<span style="color: teal;">ASCIIEncoding</span>();</p> 
<p style="margin: 0px;">&nbsp;</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">string</span> TempMetaData = AEnc.GetString(MetaArray);</p> 
<p style="margin: 0px;">&nbsp;</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: green;">//Trim it down</span></p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">int</span> StartPosition = TempMetaData.IndexOf(<span style="color: maroon;">"'"</span>) + 1;</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">int</span> EndPosition = TempMetaData.IndexOf(<span style="color: maroon;">"';"</span>, StartPosition);</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; TempMetaData = TempMetaData.Substring(StartPosition, EndPosition - StartPosition);</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: teal;">Console</span>.WriteLine(TempMetaData);</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; BlockCount = 0;</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">continue</span>;</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">else</span></p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; data[BlockCount] = b;</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; BlockCount = BlockCount + 1;</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">finally</span></p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; oReader.Close();</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; mw.Close();</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; plex.ClosePlayer();</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }</p> 
<p style="margin: 0px;">&nbsp;</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">private</span> <span style="color: blue;">void</span> Form1_FormClosed(System.<span style="color: teal;">Object</span> sender, System.Windows.Forms.<span style="color: teal;">FormClosedEventArgs</span> e)</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; btnStop.PerformClick();</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }</p> 
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; }</p> 
<p style="margin: 0px;">}</p> 
</div> 
</div> 
</a><br><a href="#questions" class="standardsButton"><font color="#ffffff"> 
		Up
		</font></a></td></tr><tr><td><a name="tip69"><h2>69. I try to convert a file on my web page but the process get stuck.
The web page seems like it tries to load something but won't go on. What can I do?</h2> 
Demo version shows the Nag-Screen. Use the Alt+Tab to find it and click "OK" button.
</a><br><a href="#questions" class="standardsButton"><font color="#ffffff"> 
		Up
		</font></a></td></tr><tr><td><a name="tip70"><h2>70. I'm trying to trial your software, building it into our web application 
but the trial version I have downloaded won't work in my web app as it keeps 
trying to pop up a 'nag screen' which causes the app to throw an error. Is 
there any way to turn this off?</h2> 
For test this you need start your web app under built-in VisualStudio web server instead of IIS and press NagScreen "OK" button. <br/> 
Please use Alt+Tab for find NagScreen. This is limitation of the trial version.
</a><br><a href="#questions" class="standardsButton"><font color="#ffffff"> 
		Up
		</font></a></td></tr><tr><td><a name="tip71"><h2>71. We are evaluating your Alvas.Audio product for a .net server side mixer 
and aren't able to evaluate it completely since we keep getting this error:
 
'Showing a modal dialog box or form when the application is not running in 
UserInteractive mode is not a valid operation. Specify the 
ServiceNotification or DefaultDesktopOnly style to display a notification 
from a service application.'
 
The error seems to come from the Alvas.Audio.AboutBox.ShowNagScreen, which I 
would guess has to do that we are running a demo.
 
Is there any way of testing server side things without getting that error 
just to make sure that it works for our project?</h2> 
What type of applications do you use? For test purpose please<br/> 
1. use the built-in VisualStudio webserver instead of IIS for ASP.Net application.<br/> 
2. Or use the console application instead of Windows Service.<br/> 
</a><br><a href="#questions" class="standardsButton"><font color="#ffffff"> 
		Up
		</font></a></td></tr><tr><td><a name="tip72"><h2>72. When converting audio from Wav to Mp3 and NOT using the Wave2Mp3 function, 
do you always need to convert the wave data into PCM data before converting it to MP3? 
Is there a reason for doing that?</h2> 
Wave is container format. Please see <a href=http://en.wikipedia.org/wiki/Wav target=_blank>http://en.wikipedia.org/wiki/Wav</a>.
Wave files can contain audio in various formats (PCM, ADPCM, MP3 and other).
PCM(<a href=http://en.wikipedia.org/wiki/PCM target=_blank>http://en.wikipedia.org/wiki/PCM</a>) is uncompressed format. Other audio formats are compressed.
<br/><br/> 
Before converting data from one compressed format to another they need to be unpacked in PCM (uncompressed format).<br/> 
Standard scheme of converting data: <strong>[CompressedFormat1] -> PCM -> [CompressedFormat2]</strong>.
</a><br><a href="#questions" class="standardsButton"><font color="#ffffff"> 
		Up
		</font></a></td></tr><tr><td><a name="tip73"><h2>73. I have to connect to a SHOUTcast stream, take 5 seconds of the sound then detect if there is silence (no sound above -14db). Would you be so kind to provide us with some sample?</h2> 
<div class=code> 
<div style="font-family: Courier New; font-size: 10pt; color: black; background: white;"><p style="margin: 0px;"><span style="color: blue;">using</span> System;</p><p style="margin: 0px;"><span style="color: blue;">using</span> System.Windows.Forms;</p><p style="margin: 0px;"><span style="color: blue;">using</span> System.Net;</p><p style="margin: 0px;"><span style="color: blue;">using</span> System.IO;</p><p style="margin: 0px;"><span style="color: blue;">using</span> Alvas.Audio;</p><p style="margin: 0px;">&nbsp;</p><p style="margin: 0px;"><span style="color: blue;">namespace</span> RadioCs</p><p style="margin: 0px;">{</p><p style="margin: 0px;">&nbsp;&nbsp;&nbsp; <span style="color: blue;">public</span> <span style="color: blue;">partial</span> <span style="color: blue;">class</span> <span style="color: teal;">frmMain</span> : <span style="color: teal;">Form</span></p><p style="margin: 0px;">&nbsp;&nbsp;&nbsp; {</p><p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">public</span> frmMain()</p><p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {</p><p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; InitializeComponent();</p><p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; t.Interval = 15 * 60 * 1000;</p><p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; t.Tick += <span style="color: blue;">new</span> <span style="color: teal;">EventHandler</span>(t_Tick);</p><p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; t.Enabled = <span style="color: blue;">true</span>;</p><p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }</p><p style="margin: 0px;">&nbsp;</p><p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: teal;">Timer</span> t = <span style="color: blue;">new</span> <span style="color: teal;">Timer</span>();</p><p style="margin: 0px;">&nbsp;</p><p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">void</span> t_Tick(<span style="color: blue;">object</span> sender, <span style="color: teal;">EventArgs</span> e)</p><p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {</p><p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">if</span> (CheckSilent(<span style="color: maroon;">"http://www.wmph.org:7050/wmph64k"</span>, 10000, -14))</p><p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {</p><p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: teal;">Console</span>.WriteLine(<span style="color: maroon;">"Alert!"</span>);</p><p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }</p><p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }</p><p style="margin: 0px;">&nbsp;</p><p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">private</span> <span style="color: blue;">static</span> <span style="color: blue;">short</span> dB2Short(<span style="color: blue;">double</span> dB)</p><p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {</p><p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">double</span> times = <span style="color: teal;">Math</span>.Pow(10, dB / 10);</p><p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">return</span> (<span style="color: blue;">short</span>)(<span style="color: blue;">short</span>.MaxValue * times);</p><p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }</p><p style="margin: 0px;">&nbsp;</p><p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">private</span> <span style="color: blue;">bool</span> CheckSilent(<span style="color: blue;">string</span> StreamURL, <span style="color: blue;">int</span> timeOut, <span style="color: blue;">double</span> mindb)</p><p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {</p><p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: teal;">HttpWebRequest</span> WebReq = (<span style="color: teal;">HttpWebRequest</span>)<span style="color: teal;">WebRequest</span>.Create(StreamURL);</p><p style="margin: 0px;">&nbsp;</p><p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: teal;">Uri</span> MyURI = <span style="color: blue;">new</span> <span style="color: teal;">Uri</span>(StreamURL);</p><p style="margin: 0px;">&nbsp;</p><p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; WebReq.Headers.Clear();</p><p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; WebReq.Timeout = timeOut;</p><p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; WebReq.Headers.Add(<span style="color: maroon;">"GET"</span>, MyURI.AbsolutePath + <span style="color: maroon;">" HTTP/1.0"</span>);</p><p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; WebReq.UserAgent = <span style="color: maroon;">"WinampMPEG/5.0"</span>;</p><p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; WebReq.Headers.Add(<span style="color: maroon;">"Icy-MetaData"</span>, <span style="color: maroon;">"1"</span>);</p><p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: teal;">WebResponse</span> WebRes = WebReq.GetResponse();</p><p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: teal;">Stream</span> oReader = WebRes.GetResponseStream();</p><p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">int</span> MetaInterval = <span style="color: blue;">int</span>.Parse(WebRes.Headers[<span style="color: maroon;">"icy-metaint"</span>]);</p><p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">byte</span>[] data = <span style="color: blue;">new</span> <span style="color: blue;">byte</span>[MetaInterval];</p><p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">byte</span> b = 0;</p><p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">int</span> BlockCount = 0;</p><p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">int</span> pass = 0;</p><p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: teal;">MemoryStream</span> ms = <span style="color: blue;">new</span> <span style="color: teal;">MemoryStream</span>();</p><p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">try</span></p><p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {</p><p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">while</span> (<span style="color: blue;">true</span>)</p><p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {</p><p style="margin: 0px;">&nbsp;</p><p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; b = (<span style="color: blue;">byte</span>)oReader.ReadByte();</p><p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">if</span> (BlockCount == MetaInterval)</p><p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {</p><p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; ms.Write(data, 0, data.Length);</p><p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; pass += 1;</p><p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">if</span> (pass &gt;= 5)</p><p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {</p><p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: teal;">Mp3Reader</span> mr = <span style="color: blue;">new</span> <span style="color: teal;">Mp3Reader</span>(ms);</p><p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: teal;">IntPtr</span> format = mr.ReadFormat();</p><p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">short</span>[] buffer = <span style="color: teal;">AudioCompressionManager</span>.RecalculateData(format, ms.ToArray(), -1);</p><p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; mr.Close();</p><p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">int</span> silentLevel = dB2Short(mindb);</p><p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">for</span> (<span style="color: blue;">int</span> i = 0; i &lt; buffer.Length; i++)</p><p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {</p><p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">if</span> (buffer[i] &gt; silentLevel)</p><p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {</p><p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">return</span> <span style="color: blue;">false</span>;</p><p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }</p><p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }</p><p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">return</span> <span style="color: blue;">true</span>;</p><p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }</p><p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">int</span> MetaDataLength = b * 16;</p><p style="margin: 0px;">&nbsp;</p><p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">if</span> (MetaDataLength &gt; 0)<span style="color: green;">//skip metadata</span></p><p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {</p><p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">byte</span>[] MetaArray = <span style="color: blue;">new</span> <span style="color: blue;">byte</span>[MetaDataLength];</p><p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; oReader.Read(MetaArray, 0, MetaDataLength);</p><p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }</p><p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; BlockCount = 0;</p><p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">continue</span>;</p><p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }</p><p style="margin: 0px;">&nbsp;</p><p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">else</span></p><p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {</p><p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; data[BlockCount] = b;</p><p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }</p><p style="margin: 0px;">&nbsp;</p><p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; BlockCount = BlockCount + 1;</p><p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }</p><p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }</p><p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">finally</span></p><p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {</p><p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; oReader.Close();</p><p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }</p><p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }</p><p style="margin: 0px;">&nbsp;</p><p style="margin: 0px;">&nbsp;&nbsp;&nbsp; }</p><p style="margin: 0px;">}</p></div> 
</div> 
</a><br><a href="#questions" class="standardsButton"><font color="#ffffff"> 
		Up
		</font></a></td></tr><tr><td><a name="tip74"><h2>74. I have multiple audio tracks with nothing but music.
     I have multiple recorded voice tracks no longer than 2-3 seconds each.
     What I would like to do is 'overlay' a voice track onto an audio
track at a specified time and output the results to a single file.
     E.g. Audio track is 2 minutes long, and I would like to insert
the voice track at 23 seconds as well 1m 05 seconds and at 1m 40
seconds.
Can Alvas.Audio accomplish this sort of task for me??</h2> 
<div class=code> 
<div style="font-family: Courier New; font-size: 10pt; color: black; background: white;"><p style="margin: 0px;"><span style="color: blue;">Imports</span> System.IO</p><p style="margin: 0px;"><span style="color: blue;">Imports</span> Alvas.Audio</p><p style="margin: 0px;">&nbsp;</p><p style="margin: 0px;"><span style="color: blue;">Public</span> <span style="color: blue;">Class</span> Form1</p><p style="margin: 0px;">&nbsp;</p><p style="margin: 0px;">&nbsp;&nbsp;&nbsp; <span style="color: blue;">Private</span> <span style="color: blue;">Sub</span> Button1_Click(<span style="color: blue;">ByVal</span> sender <span style="color: blue;">As</span> System.Object, <span style="color: blue;">ByVal</span> e <span style="color: blue;">As</span> System.EventArgs) <span style="color: blue;">Handles</span> Button1.Click</p><p style="margin: 0px;">&nbsp;</p><p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; MixMany(<span style="color: maroon;">"c:\audio\files\"</span>)</p><p style="margin: 0px;">&nbsp;</p><p style="margin: 0px;">&nbsp;&nbsp;&nbsp; <span style="color: blue;">End</span> <span style="color: blue;">Sub</span></p><p style="margin: 0px;">&nbsp;</p><p style="margin: 0px;">&nbsp;&nbsp;&nbsp; <span style="color: blue;">Private</span> <span style="color: blue;">Shared</span> <span style="color: blue;">Sub</span> Debug(<span style="color: blue;">ByVal</span> name <span style="color: blue;">As</span> <span style="color: blue;">String</span>, <span style="color: blue;">ByVal</span> wf <span style="color: blue;">As</span> WaveFormat)</p><p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">Dim</span> format <span style="color: blue;">As</span> <span style="color: blue;">String</span> = <span style="color: maroon;">"Variable: [{0}], FormatTag: {1}, Channels: {2}, SamplesPerSec: {3}, BitsPerSample: {4}, BlockAlign: {5}, AvgBytesPerSec: {6}"</span></p><p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; Console.WriteLine(format, name, wf.wFormatTag, wf.nChannels, wf.nSamplesPerSec, wf.wBitsPerSample, wf.nBlockAlign, wf.nAvgBytesPerSec)</p><p style="margin: 0px;">&nbsp;&nbsp;&nbsp; <span style="color: blue;">End</span> <span style="color: blue;">Sub</span></p><p style="margin: 0px;">&nbsp;</p><p style="margin: 0px;">&nbsp;&nbsp;&nbsp; <span style="color: blue;">Private</span> <span style="color: blue;">Shared</span> <span style="color: blue;">Sub</span> MixMany(<span style="color: blue;">ByVal</span> dir <span style="color: blue;">As</span> <span style="color: blue;">String</span>)</p><p style="margin: 0px;">&nbsp;</p><p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">Dim</span> format1 <span style="color: blue;">As</span> IntPtr</p><p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">Dim</span> data1 <span style="color: blue;">As</span> <span style="color: blue;">Byte</span>()</p><p style="margin: 0px;">&nbsp;</p><p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; ReadData(dir + <span style="color: maroon;">"The Friendship Song.mp3"</span>, format1, data1)</p><p style="margin: 0px;">&nbsp;</p><p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">Dim</span> format2 <span style="color: blue;">As</span> IntPtr</p><p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">Dim</span> data2 <span style="color: blue;">As</span> <span style="color: blue;">Byte</span>()</p><p style="margin: 0px;">&nbsp;</p><p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; ReadData(dir + <span style="color: maroon;">"Kailin 1.mp3"</span>, format2, data2)</p><p style="margin: 0px;">&nbsp;</p><p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">Dim</span> wf1 <span style="color: blue;">As</span> WaveFormat = AudioCompressionManager.GetWaveFormat(format1)</p><p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; Debug(<span style="color: maroon;">"wf1"</span>, wf1)</p><p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">Dim</span> wf2 <span style="color: blue;">As</span> WaveFormat = AudioCompressionManager.GetWaveFormat(format2)</p><p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; Debug(<span style="color: maroon;">"wf1"</span>, wf2)</p><p style="margin: 0px;">&nbsp;</p><p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">If</span> <span style="color: blue;">Not</span> wf1.Equals(wf2) <span style="color: blue;">Then</span></p><p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; data2 = AudioCompressionManager.Convert(format2, format1, data2, <span style="color: blue;">False</span>)</p><p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">End</span> <span style="color: blue;">If</span></p><p style="margin: 0px;">&nbsp;</p><p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">Dim</span> data <span style="color: blue;">As</span> <span style="color: blue;">Byte</span>() = AudioCompressionManager.MixMany(format1, data1, data2, wf1.nSamplesPerSec * 27.1, wf1.nSamplesPerSec * 83.28)</p><p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">Dim</span> formatMp3 <span style="color: blue;">As</span> IntPtr = AudioCompressionManager.GetCompatibleFormat(format1, AudioCompressionManager.MpegLayer3FormatTag)</p><p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; Debug(<span style="color: maroon;">"wfMp3"</span>, AudioCompressionManager.GetWaveFormat(formatMp3))</p><p style="margin: 0px;">&nbsp;</p><p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">Dim</span> dataMp3 <span style="color: blue;">As</span> <span style="color: blue;">Byte</span>() = AudioCompressionManager.Convert(format1, formatMp3, data, <span style="color: blue;">False</span>)</p><p style="margin: 0px;">&nbsp;</p><p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">Dim</span> mw <span style="color: blue;">As</span> <span style="color: blue;">New</span> Mp3Writer(File.Create(dir + <span style="color: maroon;">"Test002.mp3"</span>))</p><p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; mw.WriteData(dataMp3)</p><p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; mw.Close()</p><p style="margin: 0px;">&nbsp;</p><p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; MsgBox(<span style="color: maroon;">"Done!"</span>)</p><p style="margin: 0px;">&nbsp;</p><p style="margin: 0px;">&nbsp;&nbsp;&nbsp; <span style="color: blue;">End</span> <span style="color: blue;">Sub</span></p><p style="margin: 0px;">&nbsp;</p><p style="margin: 0px;">&nbsp;&nbsp;&nbsp; <span style="color: blue;">Private</span> <span style="color: blue;">Shared</span> <span style="color: blue;">Sub</span> ReadData(<span style="color: blue;">ByVal</span> fileName <span style="color: blue;">As</span> <span style="color: blue;">String</span>, <span style="color: blue;">ByRef</span> format1 <span style="color: blue;">As</span> IntPtr, <span style="color: blue;">ByRef</span> data1 <span style="color: blue;">As</span> <span style="color: blue;">Byte</span>())</p><p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">Dim</span> dr1 <span style="color: blue;">As</span> <span style="color: blue;">New</span> Mp3Reader(File.OpenRead(fileName))</p><p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; format1 = dr1.ReadFormat()</p><p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; data1 = dr1.ReadData()</p><p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; dr1.Close()</p><p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">Dim</span> format1Pcm <span style="color: blue;">As</span> IntPtr = AudioCompressionManager.GetCompatibleFormat(format1, AudioCompressionManager.PcmFormatTag)</p><p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">Dim</span> data1Pcm() <span style="color: blue;">As</span> <span style="color: blue;">Byte</span> = AudioCompressionManager.Convert(format1, format1Pcm, data1, <span style="color: blue;">False</span>)</p><p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; format1 = format1Pcm</p><p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; data1 = data1Pcm</p><p style="margin: 0px;">&nbsp;&nbsp;&nbsp; <span style="color: blue;">End</span> <span style="color: blue;">Sub</span></p><p style="margin: 0px;">&nbsp;</p><p style="margin: 0px;"><span style="color: blue;">End</span> <span style="color: blue;">Class</span></p></div> 
</div> 
</a><br><a href="#questions" class="standardsButton"><font color="#ffffff"> 
		Up
		</font></a></td></tr><tr><td><a name="tip75"><h2>75. Effectively, I have a block of memory which contains A-law data and I want to play the data using vb.net. 
Can you provide some sample code on how I can achieve this with PlayerEx?</h2> 
<div class=code> 
<div style="font-family: Courier New; font-size: 10pt; color: black; background: white;"><p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">Private</span> playEx <span style="color: blue;">As</span> PlayerEx = <span style="color: blue;">New</span> PlayerEx()</p><p style="margin: 0px;">&nbsp;</p><p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">Private</span> <span style="color: blue;">Sub</span> Play(<span style="color: blue;">ByVal</span> data <span style="color: blue;">As</span> <span style="color: blue;">Byte</span>())</p><p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">Dim</span> wf <span style="color: blue;">As</span> WaveFormat = <span style="color: blue;">New</span> WaveFormat()</p><p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; wf.wFormatTag = AudioCompressionManager.MuLawFormatTag <span style="color: green;">' or AudioCompressionManager.ALawFormatTag</span></p><p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; wf.nChannels = 1 <span style="color: green;">' or 2</span></p><p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; wf.nSamplesPerSec = 8000 <span style="color: green;">' or other</span></p><p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">Dim</span> format <span style="color: blue;">As</span> IntPtr = AudioCompressionManager.GetFormatList(wf)(0).FormatHandle</p><p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; playEx.OpenPlayer(format)</p><p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; playEx.AddData(data)</p><p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; playEx.StartPlay()</p><p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">End</span> <span style="color: blue;">Sub</span></p></div> 
</div> 
</a><br><a href="#questions" class="standardsButton"><font color="#ffffff"> 
		Up
		</font></a></td></tr><tr><td><a name="tip76"><h2>76. Can I use Alvas.Audio to play(stream) MP3 from the buffer of byte array. 
Please explain it with sample code in c#.</h2> 
<div class=code> 
<div style="font-family: Courier New; font-size: 10pt; color: black; background: white;"><p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">private</span> <span style="color: blue;">void</span> btnTest_Click(<span style="color: blue;">object</span> sender, <span style="color: teal;">EventArgs</span> e)</p><p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {</p><p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; PlayMp3Array(<span style="color: teal;">File</span>.ReadAllBytes(<span style="color: maroon;">"play.mp3"</span>));</p><p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }</p><p style="margin: 0px;">&nbsp;</p><p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: teal;">PlayerEx</span> plex = <span style="color: blue;">new</span> <span style="color: teal;">PlayerEx</span>();</p><p style="margin: 0px;">&nbsp;</p><p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">private</span> <span style="color: blue;">void</span> PlayMp3Array(<span style="color: blue;">byte</span>[] data)</p><p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {</p><p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: teal;">MemoryStream</span> ms = <span style="color: blue;">new</span> <span style="color: teal;">MemoryStream</span>(data);</p><p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: teal;">Mp3Reader</span> mr = <span style="color: blue;">new</span> <span style="color: teal;">Mp3Reader</span>(ms);</p><p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; plex.OpenPlayer(mr.ReadFormat());</p><p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; plex.AddData(mr.ReadData());</p><p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; mr.Close();</p><p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; plex.StartPlay();</p><p style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }</p></div> 
</div> 
</a><br><a href="#questions" class="standardsButton"><font color="#ffffff"> 
		Up
		</font></a></td></tr><tr height="100%" colspan="2"><td></td></tr></table> 
 

</body></html>